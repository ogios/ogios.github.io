import{f as V,r as b,g,al as l,o as E,a as F,E as R,an as W,b as n,c as o,a8 as a,ab as H,ay as $,az as J,N as O,a3 as j,u as A}from"./@vue-9c35b395.js";import{_ as L}from"./TextEditor.vue_vue_type_style_index_0_lang-3005378c.js";import{Q}from"./@element-plus-b13bee2d.js";import{C as Y}from"./CategorySelector-00e3e5e9.js";import{c as Z,d as q,e as G}from"./index-4c5ea7d8.js";import{u as K}from"./vue-router-7dca9bdd.js";import{E as P}from"./element-plus-db509607.js";import{_ as X}from"./index-27abbdca.js";import"./@tiptap-05fbaccf.js";import"./prosemirror-state-196a664c.js";import"./prosemirror-model-dd95f3ae.js";import"./orderedmap-1b52af60.js";import"./prosemirror-transform-8da7cd1c.js";import"./tippy.js-85fd885f.js";import"./@popperjs-38034195.js";import"./prosemirror-view-90e8c06d.js";import"./prosemirror-dropcursor-450722bb.js";import"./prosemirror-gapcursor-b6f07352.js";import"./prosemirror-keymap-f78d9d43.js";import"./w3c-keyname-a25e4cc1.js";import"./prosemirror-history-2c775b3b.js";import"./rope-sequence-5ceeafee.js";import"./prosemirror-tables-cc8976a2.js";import"./prosemirror-commands-19b3babd.js";import"./prosemirror-schema-list-20593f03.js";import"./linkifyjs-32d7b0b9.js";import"./highlight.js-f63ffb7b.js";import"./ant-design-vue-b9441150.js";import"./@babel-aba2881e.js";import"./@ant-design-590e9d8f.js";import"./@ctrl-fb5a5473.js";import"./dom-align-ecb06dd6.js";import"./resize-observer-polyfill-0f9f8adb.js";import"./lodash-es-f35ec05a.js";import"./dayjs-ab63237d.js";import"./vue-types-ef06c517.js";import"./@emotion-f7664732.js";import"./stylis-fad5b415.js";import"./remixicon-0d963432.js";import"./lowlight-dcc438ad.js";import"./fault-884b1697.js";import"./format-0c58afb4.js";import"./BlogStore-0417d5b8.js";import"./pinia-9bc35aa3.js";import"./@vueuse-ffe6a0dc.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-2a4cb2fa.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-7cc3f4ab.js";import"./axios-4a70c6fc.js";const x=m=>($("data-v-e03e8762"),m=m(),J(),m),tt={class:"out_page",style:{padding:"1em"}},et={style:{"margin-top":"3em"}},ot=x(()=>n("h2",{style:{margin:"0"}},"配置",-1)),nt={class:"grid-content"},it={class:"grid-content"},lt=x(()=>n("label",{slot:"tip",class:"el-upload__tip"},"Head image",-1)),at={style:{display:"block"}},st={class:"edit_buttons",style:{"text-align":"center",margin:"2em"}},rt={name:"NewBlog"},pt=V({...rt,setup(m){const S=K(),c=200,s=b({categoryId:1,content:"",headImg:"",isFinished:0,isTop:0,summary:"",title:"",tabs:[]}),d=g(),r=b([]);function C(t,e){console.log(e),r.pop(),r.push(e[0].raw)}function I(){r.pop()}function N(){return d.value.editor.getHTML()}function f(){return d.value.editor.getText({blockSeparator:`

`})}function h(t,e,i=""){return t.content=e,t.headImg=i,t.summary=t.summary.length===0?f().replace(`
`,"").slice(0,c-5)+(f().length>c?"...":""):t.summary,t}const y=()=>document.documentElement.clientWidth>600?12:24,u=g(y());window.onresize=()=>(()=>{u.value=y()})();const v=g(0),k=t=>{console.log("content update"),v.value=t};async function T(){let t=JSON.parse(JSON.stringify(s));const e=await Z(N());if(r.length>0){const i=await q(r[0]);t=h(t,e.content,i.imageName)}else t=h(t,e.content);console.log(t),G(t).then(i=>{P.success(`文章已上传: ${i.id}`);const _=i.id;console.log("id: ",_),S.push({name:"blogs"})})}return(t,e)=>{const i=l("el-divider"),_=l("el-input"),w=l("el-col"),U=l("el-upload"),B=l("el-row"),M=l("el-icon"),z=l("el-button"),D=l("el-tooltip");return E(),F("div",tt,[R(n("textarea",{"onUpdate:modelValue":e[0]||(e[0]=p=>s.title=p),placeholder:"Title",rows:"1"},null,512),[[W,s.title]]),o(L,{ref_key:"editor",ref:d,editable:!0,content:" ",onMonitorSize:k},null,512),n("div",et,[o(i,null,{default:a(()=>[O("配置文件")]),_:1}),ot,o(_,{modelValue:s.summary,"onUpdate:modelValue":e[1]||(e[1]=p=>s.summary=p),maxlength:c,autosize:{minRows:5,maxRows:5},placeholder:"文章总结","show-word-limit":"",type:"textarea"},null,8,["modelValue"]),o(B,{class:"row-bg",justify:"center"},{default:a(()=>[o(w,{span:u.value},{default:a(()=>[n("div",nt,[o(Y,{"upload-data":s,"onUpdate:uploadData":e[2]||(e[2]=p=>s=p),style:{display:"inline-block",overflow:"hidden",width:"100%"}},null,8,["upload-data"])])]),_:1},8,["span"]),o(w,{span:u.value.toString()},{default:a(()=>[n("div",it,[o(U,{"auto-upload":!1,class:j({hide:r.length>0}),"file-list":r,multiple:!1,"on-change":C,"on-remove":I,action:"","list-type":"picture-card",style:{display:"inline-block","margin-top":"1em","margin-bottom":"1em"}},{default:a(()=>[lt]),_:1},8,["class","file-list"])])]),_:1},8,["span"])]),_:1})]),n("label",null,"文本大小: "+H(Math.round(v.value/1024/1024*100)/100)+"MB",1),n("div",at,[n("div",st,[o(D,{class:"box-item",content:"Upload",effect:"dark",placement:"bottom-start"},{default:a(()=>[o(z,{color:"#faebd7",circle:"",style:{border:"1px solid black",width:"5em",height:"5em"},onClick:T},{default:a(()=>[o(M,{size:17},{default:a(()=>[o(A(Q))]),_:1})]),_:1})]),_:1})])])])}}});const se=X(pt,[["__scopeId","data-v-e03e8762"]]);export{se as default};
