import{P as z,a as G,S as fe,T as U,N as ge,E as Fn}from"./prosemirror-state-196a664c.js";import{t as tn}from"./tippy.js-85fd885f.js";import{s as Kn,d as ot,e as Ie,r as nn,m as sn,f as me,h as ae,g as Be,p as Tt,i as Wn,j as zn,w as Vn,n as Un,u as qn,T as Gn}from"./@vue-9c35b395.js";import{E as Jn,D as Xn,a as Qn}from"./prosemirror-view-90e8c06d.js";import{d as Yn}from"./prosemirror-dropcursor-450722bb.js";import{g as Zn}from"./prosemirror-gapcursor-b6f07352.js";import{u as es,r as ts,h as ns}from"./prosemirror-history-2c775b3b.js";import{a as ss,b as rs,d as os,c as is,e as as,f as ls,g as cs,m as xt,s as St,t as At,h as us,i as ds,j as Ct,k as ps,C as rn,l as fs,n as hs}from"./prosemirror-tables-cc8976a2.js";import{k as ms}from"./prosemirror-keymap-f78d9d43.js";import{F as Oe,S as gs,D as bs,a as ys,b as Ms}from"./prosemirror-model-dd95f3ae.js";import{f as ks,c as it,l as vs,T as ws,a as Le,R as Es,b as Ts}from"./prosemirror-transform-8da7cd1c.js";import{c as xs,d as Ss,e as As,j as Cs,a as Os,b as Ls,f as Rs,l as Hs,g as _s,n as Ns,s as Ps,h as Is,i as Bs,k as $s,m as Ds,o as Ot,w as js}from"./prosemirror-commands-19b3babd.js";import{l as Fs,s as Ks,w as Ws}from"./prosemirror-schema-list-20593f03.js";import{r as Lt,f as at,t as Rt,a as zs}from"./linkifyjs-32d7b0b9.js";function $e(e){const{state:t,transaction:n}=e;let{selection:s}=n,{doc:r}=n,{storedMarks:i}=n;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),filterTransaction:t.filterTransaction,plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return i},get selection(){return s},get doc(){return r},get tr(){return s=n.selection,r=n.doc,i=n.storedMarks,n}}}class De{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:n,state:s}=this,{view:r}=n,{tr:i}=s,o=this.buildProps(i);return Object.fromEntries(Object.entries(t).map(([a,l])=>[a,(...u)=>{const d=l(...u)(o);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&r.dispatch(i),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,n=!0){const{rawCommands:s,editor:r,state:i}=this,{view:o}=r,a=[],l=!!t,c=t||i.tr,u=()=>(!l&&n&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(c),a.every(p=>p===!0)),d={...Object.fromEntries(Object.entries(s).map(([p,f])=>[p,(...h)=>{const b=this.buildProps(c,n),M=f(...h)(b);return a.push(M),d}])),run:u};return d}createCan(t){const{rawCommands:n,state:s}=this,r=!1,i=t||s.tr,o=this.buildProps(i,r);return{...Object.fromEntries(Object.entries(n).map(([l,c])=>[l,(...u)=>c(...u)({...o,dispatch:void 0})])),chain:()=>this.createChain(i,r)}}buildProps(t,n=!0){const{rawCommands:s,editor:r,state:i}=this,{view:o}=r;i.storedMarks&&t.setStoredMarks(i.storedMarks);const a={tr:t,editor:r,view:o,state:$e({state:i,transaction:t}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(t),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(s).map(([l,c])=>[l,(...u)=>c(...u)(a)]))}};return a}}class Vs{constructor(){this.callbacks={}}on(t,n){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(n),this}emit(t,...n){const s=this.callbacks[t];return s&&s.forEach(r=>r.apply(this,n)),this}off(t,n){const s=this.callbacks[t];return s&&(n?this.callbacks[t]=s.filter(r=>r!==n):delete this.callbacks[t]),this}removeAllListeners(){this.callbacks={}}}function v(e,t,n){return e.config[t]===void 0&&e.parent?v(e.parent,t,n):typeof e.config[t]=="function"?e.config[t].bind({...n,parent:e.parent?v(e.parent,t,n):null}):e.config[t]}function je(e){const t=e.filter(r=>r.type==="extension"),n=e.filter(r=>r.type==="node"),s=e.filter(r=>r.type==="mark");return{baseExtensions:t,nodeExtensions:n,markExtensions:s}}function on(e){const t=[],{nodeExtensions:n,markExtensions:s}=je(e),r=[...n,...s],i={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage},l=v(o,"addGlobalAttributes",a);if(!l)return;l().forEach(u=>{u.types.forEach(d=>{Object.entries(u.attributes).forEach(([p,f])=>{t.push({type:d,name:p,attribute:{...i,...f}})})})})}),r.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage},l=v(o,"addAttributes",a);if(!l)return;const c=l();Object.entries(c).forEach(([u,d])=>{const p={...i,...d};typeof(p==null?void 0:p.default)=="function"&&(p.default=p.default()),p!=null&&p.isRequired&&(p==null?void 0:p.default)===void 0&&delete p.default,t.push({type:o.name,name:u,attribute:p})})}),t}function F(e,t){if(typeof e=="string"){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}function L(...e){return e.filter(t=>!!t).reduce((t,n)=>{const s={...t};return Object.entries(n).forEach(([r,i])=>{if(!s[r]){s[r]=i;return}r==="class"?s[r]=[s[r],i].join(" "):r==="style"?s[r]=[s[r],i].join("; "):s[r]=i}),s},{})}function et(e,t){return t.filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(e.attrs)||{}:{[n.name]:e.attrs[n.name]}).reduce((n,s)=>L(n,s),{})}function an(e){return typeof e=="function"}function x(e,t=void 0,...n){return an(e)?t?e.bind(t)(...n):e(...n):e}function Us(e={}){return Object.keys(e).length===0&&e.constructor===Object}function qs(e){return typeof e!="string"?e:e.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(e):e==="true"?!0:e==="false"?!1:e}function Ht(e,t){return e.style?e:{...e,getAttrs:n=>{const s=e.getAttrs?e.getAttrs(n):e.attrs;if(s===!1)return!1;const r=t.reduce((i,o)=>{const a=o.attribute.parseHTML?o.attribute.parseHTML(n):qs(n.getAttribute(o.name));return a==null?i:{...i,[o.name]:a}},{});return{...s,...r}}}}function _t(e){return Object.fromEntries(Object.entries(e).filter(([t,n])=>t==="attrs"&&Us(n)?!1:n!=null))}function Gs(e,t){var n;const s=on(e),{nodeExtensions:r,markExtensions:i}=je(e),o=(n=r.find(c=>v(c,"topNode")))===null||n===void 0?void 0:n.name,a=Object.fromEntries(r.map(c=>{const u=s.filter(M=>M.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:t},p=e.reduce((M,k)=>{const C=v(k,"extendNodeSchema",d);return{...M,...C?C(c):{}}},{}),f=_t({...p,content:x(v(c,"content",d)),marks:x(v(c,"marks",d)),group:x(v(c,"group",d)),inline:x(v(c,"inline",d)),atom:x(v(c,"atom",d)),selectable:x(v(c,"selectable",d)),draggable:x(v(c,"draggable",d)),code:x(v(c,"code",d)),defining:x(v(c,"defining",d)),isolating:x(v(c,"isolating",d)),attrs:Object.fromEntries(u.map(M=>{var k;return[M.name,{default:(k=M==null?void 0:M.attribute)===null||k===void 0?void 0:k.default}]}))}),m=x(v(c,"parseHTML",d));m&&(f.parseDOM=m.map(M=>Ht(M,u)));const h=v(c,"renderHTML",d);h&&(f.toDOM=M=>h({node:M,HTMLAttributes:et(M,u)}));const b=v(c,"renderText",d);return b&&(f.toText=b),[c.name,f]})),l=Object.fromEntries(i.map(c=>{const u=s.filter(b=>b.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:t},p=e.reduce((b,M)=>{const k=v(M,"extendMarkSchema",d);return{...b,...k?k(c):{}}},{}),f=_t({...p,inclusive:x(v(c,"inclusive",d)),excludes:x(v(c,"excludes",d)),group:x(v(c,"group",d)),spanning:x(v(c,"spanning",d)),code:x(v(c,"code",d)),attrs:Object.fromEntries(u.map(b=>{var M;return[b.name,{default:(M=b==null?void 0:b.attribute)===null||M===void 0?void 0:M.default}]}))}),m=x(v(c,"parseHTML",d));m&&(f.parseDOM=m.map(b=>Ht(b,u)));const h=v(c,"renderHTML",d);return h&&(f.toDOM=b=>h({mark:b,HTMLAttributes:et(b,u)})),[c.name,f]}));return new Ms({topNode:o,nodes:a,marks:l})}function Ge(e,t){return t.nodes[e]||t.marks[e]||null}function Nt(e,t){return Array.isArray(t)?t.some(n=>(typeof n=="string"?n:n.name)===e.name):t}const Js=(e,t=500)=>{let n="";const s=e.parentOffset;return e.parent.nodesBetween(Math.max(0,s-t),s,(r,i,o,a)=>{var l,c;const u=((c=(l=r.type.spec).toText)===null||c===void 0?void 0:c.call(l,{node:r,pos:i,parent:o,index:a}))||r.textContent||"%leaf%";n+=u.slice(0,Math.max(0,s-i))}),n};function lt(e){return Object.prototype.toString.call(e)==="[object RegExp]"}class ve{constructor(t){this.find=t.find,this.handler=t.handler}}const Xs=(e,t)=>{if(lt(t))return t.exec(e);const n=t(e);if(!n)return null;const s=[n.text];return s.index=n.index,s.input=e,s.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),s.push(n.replaceWith)),s};function Je(e){var t;const{editor:n,from:s,to:r,text:i,rules:o,plugin:a}=e,{view:l}=n;if(l.composing)return!1;const c=l.state.doc.resolve(s);if(c.parent.type.spec.code||!((t=c.nodeBefore||c.nodeAfter)===null||t===void 0)&&t.marks.find(p=>p.type.spec.code))return!1;let u=!1;const d=Js(c)+i;return o.forEach(p=>{if(u)return;const f=Xs(d,p.find);if(!f)return;const m=l.state.tr,h=$e({state:l.state,transaction:m}),b={from:s-(f[0].length-i.length),to:r},{commands:M,chain:k,can:C}=new De({editor:n,state:h});p.handler({state:h,range:b,match:f,commands:M,chain:k,can:C})===null||!m.steps.length||(m.setMeta(a,{transform:m,from:s,to:r,text:i}),l.dispatch(m),u=!0)}),u}function Qs(e){const{editor:t,rules:n}=e,s=new z({state:{init(){return null},apply(r,i){const o=r.getMeta(s);return o||(r.selectionSet||r.docChanged?null:i)}},props:{handleTextInput(r,i,o,a){return Je({editor:t,from:i,to:o,text:a,rules:n,plugin:s})},handleDOMEvents:{compositionend:r=>(setTimeout(()=>{const{$cursor:i}=r.state.selection;i&&Je({editor:t,from:i.pos,to:i.pos,text:"",rules:n,plugin:s})}),!1)},handleKeyDown(r,i){if(i.key!=="Enter")return!1;const{$cursor:o}=r.state.selection;return o?Je({editor:t,from:o.pos,to:o.pos,text:`
`,rules:n,plugin:s}):!1}},isInputRules:!0});return s}function Ys(e){return typeof e=="number"}class Zs{constructor(t){this.find=t.find,this.handler=t.handler}}const er=(e,t)=>{if(lt(t))return[...e.matchAll(t)];const n=t(e);return n?n.map(s=>{const r=[s.text];return r.index=s.index,r.input=e,r.data=s.data,s.replaceWith&&(s.text.includes(s.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),r.push(s.replaceWith)),r}):[]};function tr(e){const{editor:t,state:n,from:s,to:r,rule:i}=e,{commands:o,chain:a,can:l}=new De({editor:t,state:n}),c=[];return n.doc.nodesBetween(s,r,(d,p)=>{if(!d.isTextblock||d.type.spec.code)return;const f=Math.max(s,p),m=Math.min(r,p+d.content.size),h=d.textBetween(f-p,m-p,void 0,"￼");er(h,i.find).forEach(M=>{if(M.index===void 0)return;const k=f+M.index+1,C=k+M[0].length,I={from:n.tr.mapping.map(k),to:n.tr.mapping.map(C)},D=i.handler({state:n,range:I,match:M,commands:o,chain:a,can:l});c.push(D)})}),c.every(d=>d!==null)}function nr(e){const{editor:t,rules:n}=e;let s=null,r=!1,i=!1;return n.map(a=>new z({view(l){const c=u=>{var d;s=!((d=l.dom.parentElement)===null||d===void 0)&&d.contains(u.target)?l.dom.parentElement:null};return window.addEventListener("dragstart",c),{destroy(){window.removeEventListener("dragstart",c)}}},props:{handleDOMEvents:{drop:l=>(i=s===l.dom.parentElement,!1),paste:(l,c)=>{var u;const d=(u=c.clipboardData)===null||u===void 0?void 0:u.getData("text/html");return r=!!(d!=null&&d.includes("data-pm-slice")),!1}}},appendTransaction:(l,c,u)=>{const d=l[0],p=d.getMeta("uiEvent")==="paste"&&!r,f=d.getMeta("uiEvent")==="drop"&&!i;if(!p&&!f)return;const m=c.doc.content.findDiffStart(u.doc.content),h=c.doc.content.findDiffEnd(u.doc.content);if(!Ys(m)||!h||m===h.b)return;const b=u.tr,M=$e({state:u,transaction:b});if(!(!tr({editor:t,state:M,from:Math.max(m-1,0),to:h.b-1,rule:a})||!b.steps.length))return b}}))}function sr(e){const t=e.filter((n,s)=>e.indexOf(n)!==s);return[...new Set(t)]}class pe{constructor(t,n){this.splittableMarks=[],this.editor=n,this.extensions=pe.resolve(t),this.schema=Gs(this.extensions,n),this.extensions.forEach(s=>{var r;this.editor.extensionStorage[s.name]=s.storage;const i={name:s.name,options:s.options,storage:s.storage,editor:this.editor,type:Ge(s.name,this.schema)};s.type==="mark"&&(!((r=x(v(s,"keepOnSplit",i)))!==null&&r!==void 0)||r)&&this.splittableMarks.push(s.name);const o=v(s,"onBeforeCreate",i);o&&this.editor.on("beforeCreate",o);const a=v(s,"onCreate",i);a&&this.editor.on("create",a);const l=v(s,"onUpdate",i);l&&this.editor.on("update",l);const c=v(s,"onSelectionUpdate",i);c&&this.editor.on("selectionUpdate",c);const u=v(s,"onTransaction",i);u&&this.editor.on("transaction",u);const d=v(s,"onFocus",i);d&&this.editor.on("focus",d);const p=v(s,"onBlur",i);p&&this.editor.on("blur",p);const f=v(s,"onDestroy",i);f&&this.editor.on("destroy",f)})}static resolve(t){const n=pe.sort(pe.flatten(t)),s=sr(n.map(r=>r.name));return s.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${s.map(r=>`'${r}'`).join(", ")}]. This can lead to issues.`),n}static flatten(t){return t.map(n=>{const s={name:n.name,options:n.options,storage:n.storage},r=v(n,"addExtensions",s);return r?[n,...this.flatten(r())]:n}).flat(10)}static sort(t){return t.sort((s,r)=>{const i=v(s,"priority")||100,o=v(r,"priority")||100;return i>o?-1:i<o?1:0})}get commands(){return this.extensions.reduce((t,n)=>{const s={name:n.name,options:n.options,storage:n.storage,editor:this.editor,type:Ge(n.name,this.schema)},r=v(n,"addCommands",s);return r?{...t,...r()}:t},{})}get plugins(){const{editor:t}=this,n=pe.sort([...this.extensions].reverse()),s=[],r=[],i=n.map(o=>{const a={name:o.name,options:o.options,storage:o.storage,editor:t,type:Ge(o.name,this.schema)},l=[],c=v(o,"addKeyboardShortcuts",a);let u={};if(o.type==="mark"&&o.config.exitable&&(u.ArrowRight=()=>q.handleExit({editor:t,mark:o})),c){const h=Object.fromEntries(Object.entries(c()).map(([b,M])=>[b,()=>M({editor:t})]));u={...u,...h}}const d=ms(u);l.push(d);const p=v(o,"addInputRules",a);Nt(o,t.options.enableInputRules)&&p&&s.push(...p());const f=v(o,"addPasteRules",a);Nt(o,t.options.enablePasteRules)&&f&&r.push(...f());const m=v(o,"addProseMirrorPlugins",a);if(m){const h=m();l.push(...h)}return l}).flat();return[Qs({editor:t,rules:s}),...nr({editor:t,rules:r}),...i]}get attributes(){return on(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:n}=je(this.extensions);return Object.fromEntries(n.filter(s=>!!v(s,"addNodeView")).map(s=>{const r=this.attributes.filter(l=>l.type===s.name),i={name:s.name,options:s.options,storage:s.storage,editor:t,type:F(s.name,this.schema)},o=v(s,"addNodeView",i);if(!o)return[];const a=(l,c,u,d)=>{const p=et(l,r);return o()({editor:t,node:l,getPos:u,decorations:d,HTMLAttributes:p,extension:s})};return[s.name,a]}))}}function rr(e){return Object.prototype.toString.call(e).slice(8,-1)}function Xe(e){return rr(e)!=="Object"?!1:e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function Fe(e,t){const n={...e};return Xe(e)&&Xe(t)&&Object.keys(t).forEach(s=>{Xe(t[s])?s in e?n[s]=Fe(e[s],t[s]):Object.assign(n,{[s]:t[s]}):Object.assign(n,{[s]:t[s]})}),n}class ${constructor(t={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=x(v(this,"addOptions",{name:this.name}))),this.storage=x(v(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new $(t)}configure(t={}){const n=this.extend();return n.options=Fe(this.options,t),n.storage=x(v(n,"addStorage",{name:n.name,options:n.options})),n}extend(t={}){const n=new $(t);return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=x(v(n,"addOptions",{name:n.name})),n.storage=x(v(n,"addStorage",{name:n.name,options:n.options})),n}}function ln(e,t,n){const{from:s,to:r}=t,{blockSeparator:i=`

`,textSerializers:o={}}=n||{};let a="",l=!0;return e.nodesBetween(s,r,(c,u,d,p)=>{var f;const m=o==null?void 0:o[c.type.name];m?(c.isBlock&&!l&&(a+=i,l=!0),d&&(a+=m({node:c,pos:u,parent:d,index:p,range:t}))):c.isText?(a+=(f=c==null?void 0:c.text)===null||f===void 0?void 0:f.slice(Math.max(s,u)-u,r-u),l=!1):c.isBlock&&!l&&(a+=i,l=!0)}),a}function cn(e){return Object.fromEntries(Object.entries(e.nodes).filter(([,t])=>t.spec.toText).map(([t,n])=>[t,n.spec.toText]))}const or=$.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new z({key:new G("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:e}=this,{state:t,schema:n}=e,{doc:s,selection:r}=t,{ranges:i}=r,o=Math.min(...i.map(u=>u.$from.pos)),a=Math.max(...i.map(u=>u.$to.pos)),l=cn(n);return ln(s,{from:o,to:a},{textSerializers:l})}}})]}}),ir=()=>({editor:e,view:t})=>(requestAnimationFrame(()=>{var n;e.isDestroyed||(t.dom.blur(),(n=window==null?void 0:window.getSelection())===null||n===void 0||n.removeAllRanges())}),!0),ar=(e=!1)=>({commands:t})=>t.setContent("",e),lr=()=>({state:e,tr:t,dispatch:n})=>{const{selection:s}=t,{ranges:r}=s;return n&&r.forEach(({$from:i,$to:o})=>{e.doc.nodesBetween(i.pos,o.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:u}=t,d=c.resolve(u.map(l)),p=c.resolve(u.map(l+a.nodeSize)),f=d.blockRange(p);if(!f)return;const m=vs(f);if(a.type.isTextblock){const{defaultType:h}=d.parent.contentMatchAt(d.index());t.setNodeMarkup(f.start,h)}(m||m===0)&&t.lift(f,m)})}),!0},cr=e=>t=>e(t),ur=()=>({state:e,dispatch:t})=>xs(e,t),dr=()=>({tr:e,dispatch:t})=>{const{selection:n}=e,s=n.$anchor.node();if(s.content.size>0)return!1;const r=e.selection.$anchor;for(let i=r.depth;i>0;i-=1)if(r.node(i).type===s.type){if(t){const a=r.before(i),l=r.after(i);e.delete(a,l).scrollIntoView()}return!0}return!1},pr=e=>({tr:t,state:n,dispatch:s})=>{const r=F(e,n.schema),i=t.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===r){if(s){const l=i.before(o),c=i.after(o);t.delete(l,c).scrollIntoView()}return!0}return!1},fr=e=>({tr:t,dispatch:n})=>{const{from:s,to:r}=e;return n&&t.delete(s,r),!0},hr=()=>({state:e,dispatch:t})=>Ss(e,t),mr=()=>({commands:e})=>e.keyboardShortcut("Enter"),gr=()=>({state:e,dispatch:t})=>As(e,t);function He(e,t,n={strict:!0}){const s=Object.keys(t);return s.length?s.every(r=>n.strict?t[r]===e[r]:lt(t[r])?t[r].test(e[r]):t[r]===e[r]):!0}function tt(e,t,n={}){return e.find(s=>s.type===t&&He(s.attrs,n))}function br(e,t,n={}){return!!tt(e,t,n)}function ct(e,t,n={}){if(!e||!t)return;let s=e.parent.childAfter(e.parentOffset);if(e.parentOffset===s.offset&&s.offset!==0&&(s=e.parent.childBefore(e.parentOffset)),!s.node)return;const r=tt([...s.node.marks],t,n);if(!r)return;let i=s.index,o=e.start()+s.offset,a=i+1,l=o+s.node.nodeSize;for(tt([...s.node.marks],t,n);i>0&&r.isInSet(e.parent.child(i-1).marks);)i-=1,o-=e.parent.child(i).nodeSize;for(;a<e.parent.childCount&&br([...e.parent.child(a).marks],t,n);)l+=e.parent.child(a).nodeSize,a+=1;return{from:o,to:l}}function re(e,t){if(typeof e=="string"){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}const yr=(e,t={})=>({tr:n,state:s,dispatch:r})=>{const i=re(e,s.schema),{doc:o,selection:a}=n,{$from:l,from:c,to:u}=a;if(r){const d=ct(l,i,t);if(d&&d.from<=c&&d.to>=u){const p=U.create(o,d.from,d.to);n.setSelection(p)}}return!0},Mr=e=>t=>{const n=typeof e=="function"?e(t):e;for(let s=0;s<n.length;s+=1)if(n[s](t))return!0;return!1};function ut(e){return e instanceof U}function Q(e=0,t=0,n=0){return Math.min(Math.max(e,t),n)}function un(e,t=null){if(!t)return null;const n=fe.atStart(e),s=fe.atEnd(e);if(t==="start"||t===!0)return n;if(t==="end")return s;const r=n.from,i=s.to;return t==="all"?U.create(e,Q(0,r,i),Q(e.content.size,r,i)):U.create(e,Q(t,r,i),Q(t,r,i))}function Ke(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const kr=(e=null,t={})=>({editor:n,view:s,tr:r,dispatch:i})=>{t={scrollIntoView:!0,...t};const o=()=>{Ke()&&s.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(s.focus(),t!=null&&t.scrollIntoView&&n.commands.scrollIntoView())})};if(s.hasFocus()&&e===null||e===!1)return!0;if(i&&e===null&&!ut(n.state.selection))return o(),!0;const a=un(r.doc,e)||n.state.selection,l=n.state.selection.eq(a);return i&&(l||r.setSelection(a),l&&r.storedMarks&&r.setStoredMarks(r.storedMarks),o()),!0},vr=(e,t)=>n=>e.every((s,r)=>t(s,{...n,index:r})),wr=(e,t)=>({tr:n,commands:s})=>s.insertContentAt({from:n.selection.from,to:n.selection.to},e,t);function Pt(e){const t=`<body>${e}</body>`;return new window.DOMParser().parseFromString(t,"text/html").body}function _e(e,t,n){if(n={slice:!0,parseOptions:{},...n},typeof e=="object"&&e!==null)try{return Array.isArray(e)&&e.length>0?Oe.fromArray(e.map(s=>t.nodeFromJSON(s))):t.nodeFromJSON(e)}catch(s){return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",s),_e("",t,n)}if(typeof e=="string"){const s=bs.fromSchema(t);return n.slice?s.parseSlice(Pt(e),n.parseOptions).content:s.parse(Pt(e),n.parseOptions)}return _e("",t,n)}function Er(e,t,n){const s=e.steps.length-1;if(s<t)return;const r=e.steps[s];if(!(r instanceof Es||r instanceof Ts))return;const i=e.mapping.maps[s];let o=0;i.forEach((a,l,c,u)=>{o===0&&(o=u)}),e.setSelection(fe.near(e.doc.resolve(o),n))}const Tr=e=>e.toString().startsWith("<"),xr=(e,t,n)=>({tr:s,dispatch:r,editor:i})=>{if(r){n={parseOptions:{},updateSelection:!0,...n};const o=_e(t,i.schema,{parseOptions:{preserveWhitespace:"full",...n.parseOptions}});if(o.toString()==="<>")return!0;let{from:a,to:l}=typeof e=="number"?{from:e,to:e}:e,c=!0,u=!0;if((Tr(o)?o:[o]).forEach(p=>{p.check(),c=c?p.isText&&p.marks.length===0:!1,u=u?p.isBlock:!1}),a===l&&u){const{parent:p}=s.doc.resolve(a);p.isTextblock&&!p.type.spec.code&&!p.childCount&&(a-=1,l+=1)}c?Array.isArray(t)?s.insertText(t.map(p=>p.text||"").join(""),a,l):typeof t=="object"&&t&&t.text?s.insertText(t.text,a,l):s.insertText(t,a,l):s.replaceWith(a,l,o),n.updateSelection&&Er(s,s.steps.length-1,-1)}return!0},Sr=()=>({state:e,dispatch:t})=>Cs(e,t),Ar=()=>({state:e,dispatch:t})=>Os(e,t),Cr=()=>({state:e,dispatch:t})=>Ls(e,t),Or=()=>({state:e,dispatch:t})=>Rs(e,t);function dn(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function Lr(e){const t=e.split(/-(?!$)/);let n=t[t.length-1];n==="Space"&&(n=" ");let s,r,i,o;for(let a=0;a<t.length-1;a+=1){const l=t[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))s=!0;else if(/^(c|ctrl|control)$/i.test(l))r=!0;else if(/^s(hift)?$/i.test(l))i=!0;else if(/^mod$/i.test(l))Ke()||dn()?o=!0:r=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return s&&(n=`Alt-${n}`),r&&(n=`Ctrl-${n}`),o&&(n=`Meta-${n}`),i&&(n=`Shift-${n}`),n}const Rr=e=>({editor:t,view:n,tr:s,dispatch:r})=>{const i=Lr(e).split(/-(?!$)/),o=i.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),l=t.captureTransaction(()=>{n.someProp("handleKeyDown",c=>c(n,a))});return l==null||l.steps.forEach(c=>{const u=c.map(s.mapping);u&&r&&s.maybeStep(u)}),!0};function be(e,t,n={}){const{from:s,to:r,empty:i}=e.selection,o=t?F(t,e.schema):null,a=[];e.doc.nodesBetween(s,r,(d,p)=>{if(d.isText)return;const f=Math.max(s,p),m=Math.min(r,p+d.nodeSize);a.push({node:d,from:f,to:m})});const l=r-s,c=a.filter(d=>o?o.name===d.node.type.name:!0).filter(d=>He(d.node.attrs,n,{strict:!1}));return i?!!c.length:c.reduce((d,p)=>d+p.to-p.from,0)>=l}const Hr=(e,t={})=>({state:n,dispatch:s})=>{const r=F(e,n.schema);return be(n,r,t)?Hs(n,s):!1},_r=()=>({state:e,dispatch:t})=>_s(e,t),Nr=e=>({state:t,dispatch:n})=>{const s=F(e,t.schema);return Fs(s)(t,n)},Pr=()=>({state:e,dispatch:t})=>Ns(e,t);function We(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function It(e,t){const n=typeof t=="string"?[t]:t;return Object.keys(e).reduce((s,r)=>(n.includes(r)||(s[r]=e[r]),s),{})}const Ir=(e,t)=>({tr:n,state:s,dispatch:r})=>{let i=null,o=null;const a=We(typeof e=="string"?e:e.name,s.schema);return a?(a==="node"&&(i=F(e,s.schema)),a==="mark"&&(o=re(e,s.schema)),r&&n.selection.ranges.forEach(l=>{s.doc.nodesBetween(l.$from.pos,l.$to.pos,(c,u)=>{i&&i===c.type&&n.setNodeMarkup(u,void 0,It(c.attrs,t)),o&&c.marks.length&&c.marks.forEach(d=>{o===d.type&&n.addMark(u,u+c.nodeSize,o.create(It(d.attrs,t)))})})}),!0):!1},Br=()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0),$r=()=>({tr:e,commands:t})=>t.setTextSelection({from:0,to:e.doc.content.size}),Dr=()=>({state:e,dispatch:t})=>Ps(e,t),jr=()=>({state:e,dispatch:t})=>Is(e,t),Fr=()=>({state:e,dispatch:t})=>Bs(e,t),Kr=()=>({state:e,dispatch:t})=>$s(e,t),Wr=()=>({state:e,dispatch:t})=>Ds(e,t);function pn(e,t,n={}){return _e(e,t,{slice:!1,parseOptions:n})}const zr=(e,t=!1,n={})=>({tr:s,editor:r,dispatch:i})=>{const{doc:o}=s,a=pn(e,r.schema,n);return i&&s.replaceWith(0,o.content.size,a).setMeta("preventUpdate",!t),!0};function Vr(e,t){const n=new ws(e);return t.forEach(s=>{s.steps.forEach(r=>{n.step(r)})}),n}function Ur(e){for(let t=0;t<e.edgeCount;t+=1){const{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function nt(e,t){const n=[];return e.descendants((s,r)=>{t(s)&&n.push({node:s,pos:r})}),n}function qr(e,t,n){const s=[];return e.nodesBetween(t.from,t.to,(r,i)=>{n(r)&&s.push({node:r,pos:i})}),s}function fn(e,t){for(let n=e.depth;n>0;n-=1){const s=e.node(n);if(t(s))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:s}}}function dt(e){return t=>fn(t.$from,e)}function Gr(e,t){const n=ys.fromSchema(t).serializeFragment(e),r=document.implementation.createHTMLDocument().createElement("div");return r.appendChild(n),r.innerHTML}function Jr(e,t){const n={from:0,to:e.content.size};return ln(e,n,t)}function we(e,t){const n=re(t,e.schema),{from:s,to:r,empty:i}=e.selection,o=[];i?(e.storedMarks&&o.push(...e.storedMarks),o.push(...e.selection.$head.marks())):e.doc.nodesBetween(s,r,l=>{o.push(...l.marks)});const a=o.find(l=>l.type.name===n.name);return a?{...a.attrs}:{}}function Xr(e,t){const n=F(t,e.schema),{from:s,to:r}=e.selection,i=[];e.doc.nodesBetween(s,r,a=>{i.push(a)});const o=i.reverse().find(a=>a.type.name===n.name);return o?{...o.attrs}:{}}function hn(e,t){const n=We(typeof t=="string"?t:t.name,e.schema);return n==="node"?Xr(e,t):n==="mark"?we(e,t):{}}function Qr(e,t=JSON.stringify){const n={};return e.filter(s=>{const r=t(s);return Object.prototype.hasOwnProperty.call(n,r)?!1:n[r]=!0})}function Yr(e){const t=Qr(e);return t.length===1?t:t.filter((n,s)=>!t.filter((i,o)=>o!==s).some(i=>n.oldRange.from>=i.oldRange.from&&n.oldRange.to<=i.oldRange.to&&n.newRange.from>=i.newRange.from&&n.newRange.to<=i.newRange.to))}function Zr(e){const{mapping:t,steps:n}=e,s=[];return t.maps.forEach((r,i)=>{const o=[];if(r.ranges.length)r.forEach((a,l)=>{o.push({from:a,to:l})});else{const{from:a,to:l}=n[i];if(a===void 0||l===void 0)return;o.push({from:a,to:l})}o.forEach(({from:a,to:l})=>{const c=t.slice(i).map(a,-1),u=t.slice(i).map(l),d=t.invert().map(c,-1),p=t.invert().map(u);s.push({oldRange:{from:d,to:p},newRange:{from:c,to:u}})})}),Yr(s)}function Ne(e,t,n){const s=[];return e===t?n.resolve(e).marks().forEach(r=>{const i=n.resolve(e-1),o=ct(i,r.type);o&&s.push({mark:r,...o})}):n.nodesBetween(e,t,(r,i)=>{s.push(...r.marks.map(o=>({from:i,to:i+r.nodeSize,mark:o})))}),s}function Re(e,t,n){return Object.fromEntries(Object.entries(n).filter(([s])=>{const r=e.find(i=>i.type===t&&i.name===s);return r?r.attribute.keepOnSplit:!1}))}function st(e,t,n={}){const{empty:s,ranges:r}=e.selection,i=t?re(t,e.schema):null;if(s)return!!(e.storedMarks||e.selection.$from.marks()).filter(d=>i?i.name===d.type.name:!0).find(d=>He(d.attrs,n,{strict:!1}));let o=0;const a=[];if(r.forEach(({$from:d,$to:p})=>{const f=d.pos,m=p.pos;e.doc.nodesBetween(f,m,(h,b)=>{if(!h.isText&&!h.marks.length)return;const M=Math.max(f,b),k=Math.min(m,b+h.nodeSize),C=k-M;o+=C,a.push(...h.marks.map(I=>({mark:I,from:M,to:k})))})}),o===0)return!1;const l=a.filter(d=>i?i.name===d.mark.type.name:!0).filter(d=>He(d.mark.attrs,n,{strict:!1})).reduce((d,p)=>d+p.to-p.from,0),c=a.filter(d=>i?d.mark.type!==i&&d.mark.type.excludes(i):!0).reduce((d,p)=>d+p.to-p.from,0);return(l>0?l+c:l)>=o}function eo(e,t,n={}){if(!t)return be(e,null,n)||st(e,null,n);const s=We(t,e.schema);return s==="node"?be(e,t,n):s==="mark"?st(e,t,n):!1}function Bt(e,t){const{nodeExtensions:n}=je(t),s=n.find(o=>o.name===e);if(!s)return!1;const r={name:s.name,options:s.options,storage:s.storage},i=x(v(s,"group",r));return typeof i!="string"?!1:i.split(" ").includes("list")}function to(e){var t;const n=(t=e.type.createAndFill())===null||t===void 0?void 0:t.toJSON(),s=e.toJSON();return JSON.stringify(n)===JSON.stringify(s)}function no(e){return e instanceof ge}function mn(e,t,n){const r=e.state.doc.content.size,i=Q(t,0,r),o=Q(n,0,r),a=e.coordsAtPos(i),l=e.coordsAtPos(o,-1),c=Math.min(a.top,l.top),u=Math.max(a.bottom,l.bottom),d=Math.min(a.left,l.left),p=Math.max(a.right,l.right),f=p-d,m=u-c,M={top:c,bottom:u,left:d,right:p,width:f,height:m,x:d,y:c};return{...M,toJSON:()=>M}}function so(e,t,n){var s;const{selection:r}=t;let i=null;if(ut(r)&&(i=r.$cursor),i){const a=(s=e.storedMarks)!==null&&s!==void 0?s:i.marks();return!!n.isInSet(a)||!a.some(l=>l.type.excludes(n))}const{ranges:o}=r;return o.some(({$from:a,$to:l})=>{let c=a.depth===0?e.doc.inlineContent&&e.doc.type.allowsMarkType(n):!1;return e.doc.nodesBetween(a.pos,l.pos,(u,d,p)=>{if(c)return!1;if(u.isInline){const f=!p||p.type.allowsMarkType(n),m=!!n.isInSet(u.marks)||!u.marks.some(h=>h.type.excludes(n));c=f&&m}return!c}),c})}const ro=(e,t={})=>({tr:n,state:s,dispatch:r})=>{const{selection:i}=n,{empty:o,ranges:a}=i,l=re(e,s.schema);if(r)if(o){const c=we(s,l);n.addStoredMark(l.create({...c,...t}))}else a.forEach(c=>{const u=c.$from.pos,d=c.$to.pos;s.doc.nodesBetween(u,d,(p,f)=>{const m=Math.max(f,u),h=Math.min(f+p.nodeSize,d);p.marks.find(M=>M.type===l)?p.marks.forEach(M=>{l===M.type&&n.addMark(m,h,l.create({...M.attrs,...t}))}):n.addMark(m,h,l.create(t))})});return so(s,n,l)},oo=(e,t)=>({tr:n})=>(n.setMeta(e,t),!0),io=(e,t={})=>({state:n,dispatch:s,chain:r})=>{const i=F(e,n.schema);return i.isTextblock?r().command(({commands:o})=>Ot(i,t)(n)?!0:o.clearNodes()).command(({state:o})=>Ot(i,t)(o,s)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},ao=e=>({tr:t,dispatch:n})=>{if(n){const{doc:s}=t,r=Q(e,0,s.content.size),i=ge.create(s,r);t.setSelection(i)}return!0},lo=e=>({tr:t,dispatch:n})=>{if(n){const{doc:s}=t,{from:r,to:i}=typeof e=="number"?{from:e,to:e}:e,o=U.atStart(s).from,a=U.atEnd(s).to,l=Q(r,o,a),c=Q(i,o,a),u=U.create(s,l,c);t.setSelection(u)}return!0},co=e=>({state:t,dispatch:n})=>{const s=F(e,t.schema);return Ks(s)(t,n)};function $t(e,t){const n=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(n){const s=n.filter(r=>t==null?void 0:t.includes(r.type.name));e.tr.ensureMarks(s)}}const uo=({keepMarks:e=!0}={})=>({tr:t,state:n,dispatch:s,editor:r})=>{const{selection:i,doc:o}=t,{$from:a,$to:l}=i,c=r.extensionManager.attributes,u=Re(c,a.node().type.name,a.node().attrs);if(i instanceof ge&&i.node.isBlock)return!a.parentOffset||!Le(o,a.pos)?!1:(s&&(e&&$t(n,r.extensionManager.splittableMarks),t.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;if(s){const d=l.parentOffset===l.parent.content.size;i instanceof U&&t.deleteSelection();const p=a.depth===0?void 0:Ur(a.node(-1).contentMatchAt(a.indexAfter(-1)));let f=d&&p?[{type:p,attrs:u}]:void 0,m=Le(t.doc,t.mapping.map(a.pos),1,f);if(!f&&!m&&Le(t.doc,t.mapping.map(a.pos),1,p?[{type:p}]:void 0)&&(m=!0,f=p?[{type:p,attrs:u}]:void 0),m&&(t.split(t.mapping.map(a.pos),1,f),p&&!d&&!a.parentOffset&&a.parent.type!==p)){const h=t.mapping.map(a.before()),b=t.doc.resolve(h);a.node(-1).canReplaceWith(b.index(),b.index()+1,p)&&t.setNodeMarkup(t.mapping.map(a.before()),p)}e&&$t(n,r.extensionManager.splittableMarks),t.scrollIntoView()}return!0},po=e=>({tr:t,state:n,dispatch:s,editor:r})=>{var i;const o=F(e,n.schema),{$from:a,$to:l}=n.selection,c=n.selection.node;if(c&&c.isBlock||a.depth<2||!a.sameParent(l))return!1;const u=a.node(-1);if(u.type!==o)return!1;const d=r.extensionManager.attributes;if(a.parent.content.size===0&&a.node(-1).childCount===a.indexAfter(-1)){if(a.depth===2||a.node(-3).type!==o||a.index(-2)!==a.node(-2).childCount-1)return!1;if(s){let b=Oe.empty;const M=a.index(-1)?1:a.index(-2)?2:3;for(let W=a.depth-M;W>=a.depth-3;W-=1)b=Oe.from(a.node(W).copy(b));const k=a.indexAfter(-1)<a.node(-2).childCount?1:a.indexAfter(-2)<a.node(-3).childCount?2:3,C=Re(d,a.node().type.name,a.node().attrs),I=((i=o.contentMatch.defaultType)===null||i===void 0?void 0:i.createAndFill(C))||void 0;b=b.append(Oe.from(o.createAndFill(null,I)||void 0));const D=a.before(a.depth-(M-1));t.replace(D,a.after(-k),new gs(b,4-M,0));let _=-1;t.doc.nodesBetween(D,t.doc.content.size,(W,oe)=>{if(_>-1)return!1;W.isTextblock&&W.content.size===0&&(_=oe+1)}),_>-1&&t.setSelection(U.near(t.doc.resolve(_))),t.scrollIntoView()}return!0}const p=l.pos===a.end()?u.contentMatchAt(0).defaultType:null,f=Re(d,u.type.name,u.attrs),m=Re(d,a.node().type.name,a.node().attrs);t.delete(a.pos,l.pos);const h=p?[{type:o,attrs:f},{type:p,attrs:m}]:[{type:o,attrs:f}];if(!Le(t.doc,a.pos,2))return!1;if(s){const{selection:b,storedMarks:M}=n,{splittableMarks:k}=r.extensionManager,C=M||b.$to.parentOffset&&b.$from.marks();if(t.split(a.pos,2,h).scrollIntoView(),!C||!s)return!0;const I=C.filter(D=>k.includes(D.type.name));t.ensureMarks(I)}return!0},Qe=(e,t)=>{const n=dt(o=>o.type===t)(e.selection);if(!n)return!0;const s=e.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(s===void 0)return!0;const r=e.doc.nodeAt(s);return n.node.type===(r==null?void 0:r.type)&&it(e.doc,n.pos)&&e.join(n.pos),!0},Ye=(e,t)=>{const n=dt(o=>o.type===t)(e.selection);if(!n)return!0;const s=e.doc.resolve(n.start).after(n.depth);if(s===void 0)return!0;const r=e.doc.nodeAt(s);return n.node.type===(r==null?void 0:r.type)&&it(e.doc,s)&&e.join(s),!0},fo=(e,t,n,s={})=>({editor:r,tr:i,state:o,dispatch:a,chain:l,commands:c,can:u})=>{const{extensions:d,splittableMarks:p}=r.extensionManager,f=F(e,o.schema),m=F(t,o.schema),{selection:h,storedMarks:b}=o,{$from:M,$to:k}=h,C=M.blockRange(k),I=b||h.$to.parentOffset&&h.$from.marks();if(!C)return!1;const D=dt(_=>Bt(_.type.name,d))(h);if(C.depth>=1&&D&&C.depth-D.depth<=1){if(D.node.type===f)return c.liftListItem(m);if(Bt(D.node.type.name,d)&&f.validContent(D.node.content)&&a)return l().command(()=>(i.setNodeMarkup(D.pos,f),!0)).command(()=>Qe(i,f)).command(()=>Ye(i,f)).run()}return!n||!I||!a?l().command(()=>u().wrapInList(f,s)?!0:c.clearNodes()).wrapInList(f,s).command(()=>Qe(i,f)).command(()=>Ye(i,f)).run():l().command(()=>{const _=u().wrapInList(f,s),W=I.filter(oe=>p.includes(oe.type.name));return i.ensureMarks(W),_?!0:c.clearNodes()}).wrapInList(f,s).command(()=>Qe(i,f)).command(()=>Ye(i,f)).run()},ho=(e,t={},n={})=>({state:s,commands:r})=>{const{extendEmptyMarkRange:i=!1}=n,o=re(e,s.schema);return st(s,o,t)?r.unsetMark(o,{extendEmptyMarkRange:i}):r.setMark(o,t)},mo=(e,t,n={})=>({state:s,commands:r})=>{const i=F(e,s.schema),o=F(t,s.schema);return be(s,i,n)?r.setNode(o):r.setNode(i,n)},go=(e,t={})=>({state:n,commands:s})=>{const r=F(e,n.schema);return be(n,r,t)?s.lift(r):s.wrapIn(r,t)},bo=()=>({state:e,dispatch:t})=>{const n=e.plugins;for(let s=0;s<n.length;s+=1){const r=n[s];let i;if(r.spec.isInputRules&&(i=r.getState(e))){if(t){const o=e.tr,a=i.transform;for(let l=a.steps.length-1;l>=0;l-=1)o.step(a.steps[l].invert(a.docs[l]));if(i.text){const l=o.doc.resolve(i.from).marks();o.replaceWith(i.from,i.to,e.schema.text(i.text,l))}else o.delete(i.from,i.to)}return!0}}return!1},yo=()=>({tr:e,dispatch:t})=>{const{selection:n}=e,{empty:s,ranges:r}=n;return s||t&&r.forEach(i=>{e.removeMark(i.$from.pos,i.$to.pos)}),!0},Mo=(e,t={})=>({tr:n,state:s,dispatch:r})=>{var i;const{extendEmptyMarkRange:o=!1}=t,{selection:a}=n,l=re(e,s.schema),{$from:c,empty:u,ranges:d}=a;if(!r)return!0;if(u&&o){let{from:p,to:f}=a;const m=(i=c.marks().find(b=>b.type===l))===null||i===void 0?void 0:i.attrs,h=ct(c,l,m);h&&(p=h.from,f=h.to),n.removeMark(p,f,l)}else d.forEach(p=>{n.removeMark(p.$from.pos,p.$to.pos,l)});return n.removeStoredMark(l),!0},ko=(e,t={})=>({tr:n,state:s,dispatch:r})=>{let i=null,o=null;const a=We(typeof e=="string"?e:e.name,s.schema);return a?(a==="node"&&(i=F(e,s.schema)),a==="mark"&&(o=re(e,s.schema)),r&&n.selection.ranges.forEach(l=>{const c=l.$from.pos,u=l.$to.pos;s.doc.nodesBetween(c,u,(d,p)=>{i&&i===d.type&&n.setNodeMarkup(p,void 0,{...d.attrs,...t}),o&&d.marks.length&&d.marks.forEach(f=>{if(o===f.type){const m=Math.max(p,c),h=Math.min(p+d.nodeSize,u);n.addMark(m,h,o.create({...f.attrs,...t}))}})})}),!0):!1},vo=(e,t={})=>({state:n,dispatch:s})=>{const r=F(e,n.schema);return js(r,t)(n,s)},wo=(e,t={})=>({state:n,dispatch:s})=>{const r=F(e,n.schema);return Ws(r,t)(n,s)};var Eo=Object.freeze({__proto__:null,blur:ir,clearContent:ar,clearNodes:lr,command:cr,createParagraphNear:ur,deleteCurrentNode:dr,deleteNode:pr,deleteRange:fr,deleteSelection:hr,enter:mr,exitCode:gr,extendMarkRange:yr,first:Mr,focus:kr,forEach:vr,insertContent:wr,insertContentAt:xr,joinUp:Sr,joinDown:Ar,joinBackward:Cr,joinForward:Or,keyboardShortcut:Rr,lift:Hr,liftEmptyBlock:_r,liftListItem:Nr,newlineInCode:Pr,resetAttributes:Ir,scrollIntoView:Br,selectAll:$r,selectNodeBackward:Dr,selectNodeForward:jr,selectParentNode:Fr,selectTextblockEnd:Kr,selectTextblockStart:Wr,setContent:zr,setMark:ro,setMeta:oo,setNode:io,setNodeSelection:ao,setTextSelection:lo,sinkListItem:co,splitBlock:uo,splitListItem:po,toggleList:fo,toggleMark:ho,toggleNode:mo,toggleWrap:go,undoInputRule:bo,unsetAllMarks:yo,unsetMark:Mo,updateAttributes:ko,wrapIn:vo,wrapInList:wo});const To=$.create({name:"commands",addCommands(){return{...Eo}}}),xo=$.create({name:"editable",addProseMirrorPlugins(){return[new z({key:new G("editable"),props:{editable:()=>this.editor.options.editable}})]}}),So=$.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:e}=this;return[new z({key:new G("focusEvents"),props:{handleDOMEvents:{focus:(t,n)=>{e.isFocused=!0;const s=e.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return t.dispatch(s),!1},blur:(t,n)=>{e.isFocused=!1;const s=e.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return t.dispatch(s),!1}}}})]}}),Ao=$.create({name:"keymap",addKeyboardShortcuts(){const e=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:u,$anchor:d}=l,{pos:p,parent:f}=d,m=fe.atStart(c).from===p;return!u||!m||!f.type.isTextblock||f.textContent.length?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),s={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},r={...s},i={...s,"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Ke()||dn()?i:r},addProseMirrorPlugins(){return[new z({key:new G("clearDocument"),appendTransaction:(e,t,n)=>{if(!(e.some(m=>m.docChanged)&&!t.doc.eq(n.doc)))return;const{empty:r,from:i,to:o}=t.selection,a=fe.atStart(t.doc).from,l=fe.atEnd(t.doc).to;if(r||!(i===a&&o===l)||!(n.doc.textBetween(0,n.doc.content.size," "," ").length===0))return;const d=n.tr,p=$e({state:n,transaction:d}),{commands:f}=new De({editor:this.editor,state:p});if(f.clearNodes(),!!d.steps.length)return d}})]}}),Co=$.create({name:"tabindex",addProseMirrorPlugins(){return[new z({key:new G("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});var Oo=Object.freeze({__proto__:null,ClipboardTextSerializer:or,Commands:To,Editable:xo,FocusEvents:So,Keymap:Ao,Tabindex:Co});const Lo=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 1px !important;
  height: 1px !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function Ro(e,t,n){const s=document.querySelector(`style[data-tiptap-style${n?`-${n}`:""}]`);if(s!==null)return s;const r=document.createElement("style");return t&&r.setAttribute("nonce",t),r.setAttribute(`data-tiptap-style${n?`-${n}`:""}`,""),r.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(r),r}let Ho=class extends Vs{constructor(t={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=Ro(Lo,this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,n=!0){this.setOptions({editable:t}),n&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(t,n){const s=an(n)?n(t,[...this.state.plugins]):[...this.state.plugins,t],r=this.state.reconfigure({plugins:s});this.view.updateState(r)}unregisterPlugin(t){if(this.isDestroyed)return;const n=typeof t=="string"?`${t}$`:t.key,s=this.state.reconfigure({plugins:this.state.plugins.filter(r=>!r.key.startsWith(n))});this.view.updateState(s)}createExtensionManager(){const n=[...this.options.enableCoreExtensions?Object.values(Oo):[],...this.options.extensions].filter(s=>["extension","node","mark"].includes(s==null?void 0:s.type));this.extensionManager=new pe(n,this)}createCommandManager(){this.commandManager=new De({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const t=pn(this.options.content,this.schema,this.options.parseOptions),n=un(t,this.options.autofocus);this.view=new Jn(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:Fn.create({doc:t,selection:n||void 0})});const s=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(s),this.createNodeViews();const r=this.view.dom;r.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const n=this.capturedTransaction;return this.capturedTransaction=null,n}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=t;return}t.steps.forEach(o=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(o)});return}const n=this.state.apply(t),s=!this.state.selection.eq(n.selection);this.view.updateState(n),this.emit("transaction",{editor:this,transaction:t}),s&&this.emit("selectionUpdate",{editor:this,transaction:t});const r=t.getMeta("focus"),i=t.getMeta("blur");r&&this.emit("focus",{editor:this,event:r.event,transaction:t}),i&&this.emit("blur",{editor:this,event:i.event,transaction:t}),!(!t.docChanged||t.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:t})}getAttributes(t){return hn(this.state,t)}isActive(t,n){const s=typeof t=="string"?t:null,r=typeof t=="string"?n:t;return eo(this.state,s,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Gr(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:n=`

`,textSerializers:s={}}=t||{};return Jr(this.state.doc,{blockSeparator:n,textSerializers:{...cn(this.schema),...s}})}get isEmpty(){return to(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var t;return!(!((t=this.view)===null||t===void 0)&&t.docView)}};function ce(e){return new ve({find:e.find,handler:({state:t,range:n,match:s})=>{const r=x(e.getAttributes,void 0,s);if(r===!1||r===null)return null;const{tr:i}=t,o=s[s.length-1],a=s[0];let l=n.to;if(o){const c=a.search(/\S/),u=n.from+a.indexOf(o),d=u+o.length;if(Ne(n.from,n.to,t.doc).filter(f=>f.mark.type.excluded.find(h=>h===e.type&&h!==f.mark.type)).filter(f=>f.to>u).length)return null;d<n.to&&i.delete(d,n.to),u>n.from&&i.delete(n.from+c,u),l=n.from+c+o.length,i.addMark(n.from+c,l,e.type.create(r||{})),i.removeStoredMark(e.type)}}})}function gn(e){return new ve({find:e.find,handler:({state:t,range:n,match:s})=>{const r=x(e.getAttributes,void 0,s)||{},{tr:i}=t,o=n.from;let a=n.to;if(s[1]){const l=s[0].lastIndexOf(s[1]);let c=o+l;c>a?c=a:a=c+s[1].length;const u=s[0][s[0].length-1];i.insertText(u,o+s[0].length-1),i.replaceWith(c,a,e.type.create(r))}else s[0]&&i.replaceWith(o,a,e.type.create(r))}})}function rt(e){return new ve({find:e.find,handler:({state:t,range:n,match:s})=>{const r=t.doc.resolve(n.from),i=x(e.getAttributes,void 0,s)||{};if(!r.node(-1).canReplaceWith(r.index(-1),r.indexAfter(-1),e.type))return null;t.tr.delete(n.from,n.to).setBlockType(n.from,n.from,e.type,i)}})}function P(e){return new ve({find:e.find,handler:({state:t,range:n,match:s})=>{let r=e.replace,i=n.from;const o=n.to;if(s[1]){const a=s[0].lastIndexOf(s[1]);r+=s[0].slice(a+s[1].length),i+=a;const l=i-o;l>0&&(r=s[0].slice(a-l,a)+r,i=o)}t.tr.insertText(r,i,o)}})}function he(e){return new ve({find:e.find,handler:({state:t,range:n,match:s,chain:r})=>{const i=x(e.getAttributes,void 0,s)||{},o=t.tr.delete(n.from,n.to),l=o.doc.resolve(n.from).blockRange(),c=l&&ks(l,e.type,i);if(!c)return null;if(o.wrap(l,c),e.keepMarks&&e.editor){const{selection:d,storedMarks:p}=t,{splittableMarks:f}=e.editor.extensionManager,m=p||d.$to.parentOffset&&d.$from.marks();if(m){const h=m.filter(b=>f.includes(b.type.name));o.ensureMarks(h)}}if(e.keepAttributes){const d=e.type.name==="bulletList"||e.type.name==="orderedList"?"listItem":"taskList";r().updateAttributes(d,i).run()}const u=o.doc.resolve(n.from-1).nodeBefore;u&&u.type===e.type&&it(o.doc,n.from-1)&&(!e.joinPredicate||e.joinPredicate(s,u))&&o.join(n.from-1)}})}class q{constructor(t={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=x(v(this,"addOptions",{name:this.name}))),this.storage=x(v(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new q(t)}configure(t={}){const n=this.extend();return n.options=Fe(this.options,t),n.storage=x(v(n,"addStorage",{name:n.name,options:n.options})),n}extend(t={}){const n=new q(t);return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=x(v(n,"addOptions",{name:n.name})),n.storage=x(v(n,"addStorage",{name:n.name,options:n.options})),n}static handleExit({editor:t,mark:n}){const{tr:s}=t.state,r=t.state.selection.$from;if(r.pos===r.end()){const o=r.marks();if(!!!o.find(c=>(c==null?void 0:c.type.name)===n.name))return!1;const l=o.find(c=>(c==null?void 0:c.type.name)===n.name);return l&&s.removeStoredMark(l),s.insertText(" ",r.pos),t.view.dispatch(s),!0}return!1}}class N{constructor(t={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=x(v(this,"addOptions",{name:this.name}))),this.storage=x(v(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new N(t)}configure(t={}){const n=this.extend();return n.options=Fe(this.options,t),n.storage=x(v(n,"addStorage",{name:n.name,options:n.options})),n}extend(t={}){const n=new N(t);return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=x(v(n,"addOptions",{name:n.name})),n.storage=x(v(n,"addStorage",{name:n.name,options:n.options})),n}}class _o{constructor(t,n,s){this.isDragging=!1,this.component=t,this.editor=n.editor,this.options={stopEvent:null,ignoreMutation:null,...s},this.extension=n.extension,this.node=n.node,this.decorations=n.decorations,this.getPos=n.getPos,this.mount()}mount(){}get dom(){return this.editor.view.dom}get contentDOM(){return null}onDragStart(t){var n,s,r,i,o,a,l;const{view:c}=this.editor,u=t.target,d=u.nodeType===3?(n=u.parentElement)===null||n===void 0?void 0:n.closest("[data-drag-handle]"):u.closest("[data-drag-handle]");if(!this.dom||!((s=this.contentDOM)===null||s===void 0)&&s.contains(u)||!d)return;let p=0,f=0;if(this.dom!==d){const b=this.dom.getBoundingClientRect(),M=d.getBoundingClientRect(),k=(r=t.offsetX)!==null&&r!==void 0?r:(i=t.nativeEvent)===null||i===void 0?void 0:i.offsetX,C=(o=t.offsetY)!==null&&o!==void 0?o:(a=t.nativeEvent)===null||a===void 0?void 0:a.offsetY;p=M.x-b.x+k,f=M.y-b.y+C}(l=t.dataTransfer)===null||l===void 0||l.setDragImage(this.dom,p,f);const m=ge.create(c.state.doc,this.getPos()),h=c.state.tr.setSelection(m);c.dispatch(h)}stopEvent(t){var n;if(!this.dom)return!1;if(typeof this.options.stopEvent=="function")return this.options.stopEvent({event:t});const s=t.target;if(!(this.dom.contains(s)&&!(!((n=this.contentDOM)===null||n===void 0)&&n.contains(s))))return!1;const i=t.type.startsWith("drag"),o=t.type==="drop";if((["INPUT","BUTTON","SELECT","TEXTAREA"].includes(s.tagName)||s.isContentEditable)&&!o&&!i)return!0;const{isEditable:l}=this.editor,{isDragging:c}=this,u=!!this.node.type.spec.draggable,d=ge.isSelectable(this.node),p=t.type==="copy",f=t.type==="paste",m=t.type==="cut",h=t.type==="mousedown";if(!u&&d&&i&&t.preventDefault(),u&&i&&!c)return t.preventDefault(),!1;if(u&&l&&!c&&h){const b=s.closest("[data-drag-handle]");b&&(this.dom===b||this.dom.contains(b))&&(this.isDragging=!0,document.addEventListener("dragend",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("drop",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("mouseup",()=>{this.isDragging=!1},{once:!0}))}return!(c||o||p||f||m||h&&d)}ignoreMutation(t){return!this.dom||!this.contentDOM?!0:typeof this.options.ignoreMutation=="function"?this.options.ignoreMutation({mutation:t}):this.node.isLeaf||this.node.isAtom?!0:t.type==="selection"||this.dom.contains(t.target)&&t.type==="childList"&&Ke()&&this.editor.isFocused&&[...Array.from(t.addedNodes),...Array.from(t.removedNodes)].every(s=>s.isContentEditable)?!1:this.contentDOM===t.target&&t.type==="attributes"?!0:!this.contentDOM.contains(t.target)}updateAttributes(t){this.editor.commands.command(({tr:n})=>{const s=this.getPos();return n.setNodeMarkup(s,void 0,{...this.node.attrs,...t}),!0})}deleteNode(){const t=this.getPos(),n=t+this.node.nodeSize;this.editor.commands.deleteRange({from:t,to:n})}}function se(e){return new Zs({find:e.find,handler:({state:t,range:n,match:s})=>{const r=x(e.getAttributes,void 0,s);if(r===!1||r===null)return null;const{tr:i}=t,o=s[s.length-1],a=s[0];let l=n.to;if(o){const c=a.search(/\S/),u=n.from+a.indexOf(o),d=u+o.length;if(Ne(n.from,n.to,t.doc).filter(f=>f.mark.type.excluded.find(h=>h===e.type&&h!==f.mark.type)).filter(f=>f.to>u).length)return null;d<n.to&&i.delete(d,n.to),u>n.from&&i.delete(n.from+c,u),l=n.from+c+o.length,i.addMark(n.from+c,l,e.type.create(r||{})),i.removeStoredMark(e.type)}}})}class No{constructor({editor:t,element:n,view:s,tippyOptions:r={},updateDelay:i=250,shouldShow:o}){this.preventHide=!1,this.shouldShow=({view:a,state:l,from:c,to:u})=>{const{doc:d,selection:p}=l,{empty:f}=p,m=!d.textBetween(c,u).length&&ut(l.selection),h=this.element.contains(document.activeElement);return!(!(a.hasFocus()||h)||f||m||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:a})=>{var l;if(this.preventHide){this.preventHide=!1;return}a!=null&&a.relatedTarget&&(!((l=this.element.parentNode)===null||l===void 0)&&l.contains(a.relatedTarget))||this.hide()},this.tippyBlurHandler=a=>{this.blurHandler({event:a})},this.handleDebouncedUpdate=(a,l)=>{const c=!(l!=null&&l.selection.eq(a.state.selection)),u=!(l!=null&&l.doc.eq(a.state.doc));!c&&!u||(this.updateDebounceTimer&&clearTimeout(this.updateDebounceTimer),this.updateDebounceTimer=window.setTimeout(()=>{this.updateHandler(a,c,u,l)},this.updateDelay))},this.updateHandler=(a,l,c,u)=>{var d,p,f;const{state:m,composing:h}=a,{selection:b}=m;if(h||!l&&!c)return;this.createTooltip();const{ranges:k}=b,C=Math.min(...k.map(_=>_.$from.pos)),I=Math.max(...k.map(_=>_.$to.pos));if(!((d=this.shouldShow)===null||d===void 0?void 0:d.call(this,{editor:this.editor,view:a,state:m,oldState:u,from:C,to:I}))){this.hide();return}(p=this.tippy)===null||p===void 0||p.setProps({getReferenceClientRect:((f=this.tippyOptions)===null||f===void 0?void 0:f.getReferenceClientRect)||(()=>{if(no(m.selection)){let _=a.nodeDOM(C);const W=_.dataset.nodeViewWrapper?_:_.querySelector("[data-node-view-wrapper]");if(W&&(_=W.firstChild),_)return _.getBoundingClientRect()}return mn(a,C,I)})}),this.show()},this.editor=t,this.element=n,this.view=s,this.updateDelay=i,o&&(this.shouldShow=o),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=r,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:t}=this.editor.options,n=!!t.parentElement;this.tippy||!n||(this.tippy=tn(t,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"top",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(t,n){const{state:s}=t,r=s.selection.$from.pos!==s.selection.$to.pos;if(this.updateDelay>0&&r){this.handleDebouncedUpdate(t,n);return}const i=!(n!=null&&n.selection.eq(t.state.selection)),o=!(n!=null&&n.doc.eq(t.state.doc));this.updateHandler(t,i,o,n)}show(){var t;(t=this.tippy)===null||t===void 0||t.show()}hide(){var t;(t=this.tippy)===null||t===void 0||t.hide()}destroy(){var t,n;!((t=this.tippy)===null||t===void 0)&&t.popper.firstChild&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),(n=this.tippy)===null||n===void 0||n.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const bn=e=>new z({key:typeof e.pluginKey=="string"?new G(e.pluginKey):e.pluginKey,view:t=>new No({view:t,...e})});$.create({name:"bubbleMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"bubbleMenu",updateDelay:void 0,shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[bn({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,updateDelay:this.options.updateDelay,shouldShow:this.options.shouldShow})]:[]}});class Po{constructor({editor:t,element:n,view:s,tippyOptions:r={},shouldShow:i}){this.preventHide=!1,this.shouldShow=({view:o,state:a})=>{const{selection:l}=a,{$anchor:c,empty:u}=l,d=c.depth===1,p=c.parent.isTextblock&&!c.parent.type.spec.code&&!c.parent.textContent;return!(!o.hasFocus()||!u||!d||!p||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:o})=>{var a;if(this.preventHide){this.preventHide=!1;return}o!=null&&o.relatedTarget&&(!((a=this.element.parentNode)===null||a===void 0)&&a.contains(o.relatedTarget))||this.hide()},this.tippyBlurHandler=o=>{this.blurHandler({event:o})},this.editor=t,this.element=n,this.view=s,i&&(this.shouldShow=i),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=r,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:t}=this.editor.options,n=!!t.parentElement;this.tippy||!n||(this.tippy=tn(t,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"right",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(t,n){var s,r,i;const{state:o}=t,{doc:a,selection:l}=o,{from:c,to:u}=l;if(n&&n.doc.eq(a)&&n.selection.eq(l))return;if(this.createTooltip(),!((s=this.shouldShow)===null||s===void 0?void 0:s.call(this,{editor:this.editor,view:t,state:o,oldState:n}))){this.hide();return}(r=this.tippy)===null||r===void 0||r.setProps({getReferenceClientRect:((i=this.tippyOptions)===null||i===void 0?void 0:i.getReferenceClientRect)||(()=>mn(t,c,u))}),this.show()}show(){var t;(t=this.tippy)===null||t===void 0||t.show()}hide(){var t;(t=this.tippy)===null||t===void 0||t.hide()}destroy(){var t,n;!((t=this.tippy)===null||t===void 0)&&t.popper.firstChild&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),(n=this.tippy)===null||n===void 0||n.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const yn=e=>new z({key:typeof e.pluginKey=="string"?new G(e.pluginKey):e.pluginKey,view:t=>new Po({view:t,...e})});$.create({name:"floatingMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"floatingMenu",shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[yn({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,shouldShow:this.options.shouldShow})]:[]}});const dl=me({name:"BubbleMenu",props:{pluginKey:{type:[String,Object],default:"bubbleMenu"},editor:{type:Object,required:!0},updateDelay:{type:Number,default:void 0},tippyOptions:{type:Object,default:()=>({})},shouldShow:{type:Function,default:null}},setup(e,{slots:t}){const n=Be(null);return ot(()=>{const{updateDelay:s,editor:r,pluginKey:i,shouldShow:o,tippyOptions:a}=e;r.registerPlugin(bn({updateDelay:s,editor:r,element:n.value,pluginKey:i,shouldShow:o,tippyOptions:a}))}),Ie(()=>{const{pluginKey:s,editor:r}=e;r.unregisterPlugin(s)}),()=>{var s;return ae("div",{ref:n},(s=t.default)===null||s===void 0?void 0:s.call(t))}}});function Dt(e){return Wn((t,n)=>({get(){return t(),e},set(s){e=s,requestAnimationFrame(()=>{requestAnimationFrame(()=>{n()})})}}))}class Io extends Ho{constructor(t={}){return super(t),this.vueRenderers=nn(new Map),this.contentComponent=null,this.reactiveState=Dt(this.view.state),this.reactiveExtensionStorage=Dt(this.extensionStorage),this.on("transaction",()=>{this.reactiveState.value=this.view.state,this.reactiveExtensionStorage.value=this.extensionStorage}),sn(this)}get state(){return this.reactiveState?this.reactiveState.value:this.view.state}get storage(){return this.reactiveExtensionStorage?this.reactiveExtensionStorage.value:super.storage}registerPlugin(t,n){super.registerPlugin(t,n),this.reactiveState.value=this.view.state}unregisterPlugin(t){super.unregisterPlugin(t),this.reactiveState.value=this.view.state}}const pl=me({name:"EditorContent",props:{editor:{default:null,type:Object}},setup(e){const t=Be(),n=zn();return Vn(()=>{const s=e.editor;s&&s.options.element&&t.value&&Un(()=>{if(!t.value||!s.options.element.firstChild)return;const r=qn(t.value);t.value.append(...s.options.element.childNodes),s.contentComponent=n.ctx._,s.setOptions({element:r}),s.createNodeViews()})}),Ie(()=>{const s=e.editor;if(!s||(s.isDestroyed||s.view.setProps({nodeViews:{}}),s.contentComponent=null,!s.options.element.firstChild))return;const r=document.createElement("div");r.append(...s.options.element.childNodes),s.setOptions({element:r})}),{rootEl:t}},render(){const e=[];return this.editor&&this.editor.vueRenderers.forEach(t=>{const n=ae(Gn,{to:t.teleportElement,key:t.id},ae(t.component,{ref:t.id,...t.props}));e.push(n)}),ae("div",{ref:t=>{this.rootEl=t}},...e)}}),fl=me({name:"FloatingMenu",props:{pluginKey:{type:null,default:"floatingMenu"},editor:{type:Object,required:!0},tippyOptions:{type:Object,default:()=>({})},shouldShow:{type:Function,default:null}},setup(e,{slots:t}){const n=Be(null);return ot(()=>{const{pluginKey:s,editor:r,tippyOptions:i,shouldShow:o}=e;r.registerPlugin(yn({pluginKey:s,editor:r,element:n.value,tippyOptions:i,shouldShow:o}))}),Ie(()=>{const{pluginKey:s,editor:r}=e;r.unregisterPlugin(s)}),()=>{var s;return ae("div",{ref:n},(s=t.default)===null||s===void 0?void 0:s.call(t))}}}),hl=me({props:{as:{type:String,default:"div"}},render(){return ae(this.as,{style:{whiteSpace:"pre-wrap"},"data-node-view-content":""})}}),ml=me({props:{as:{type:String,default:"div"}},inject:["onDragStart","decorationClasses"],render(){var e,t;return ae(this.as,{class:this.decorationClasses,style:{whiteSpace:"normal"},"data-node-view-wrapper":"",onDragstart:this.onDragStart},(t=(e=this.$slots).default)===null||t===void 0?void 0:t.call(e))}}),gl=(e={})=>{const t=Kn();return ot(()=>{t.value=new Io(e)}),Ie(()=>{var n;(n=t.value)===null||n===void 0||n.destroy()}),t};class Bo{constructor(t,{props:n={},editor:s}){if(this.id=Math.floor(Math.random()*4294967295).toString(),this.editor=s,this.component=sn(t),this.teleportElement=document.createElement("div"),this.element=this.teleportElement,this.props=nn(n),this.editor.vueRenderers.set(this.id,this),this.editor.contentComponent){if(this.editor.contentComponent.update(),this.teleportElement.children.length!==1)throw Error("VueRenderer doesn’t support multiple child elements.");this.element=this.teleportElement.firstElementChild}}get ref(){var t;return(t=this.editor.contentComponent)===null||t===void 0?void 0:t.refs[this.id]}updateProps(t={}){Object.entries(t).forEach(([n,s])=>{this.props[n]=s})}destroy(){this.editor.vueRenderers.delete(this.id)}}const bl={editor:{type:Object,required:!0},node:{type:Object,required:!0},decorations:{type:Object,required:!0},selected:{type:Boolean,required:!0},extension:{type:Object,required:!0},getPos:{type:Function,required:!0},updateAttributes:{type:Function,required:!0},deleteNode:{type:Function,required:!0}};class $o extends _o{mount(){const t={editor:this.editor,node:this.node,decorations:this.decorations,selected:!1,extension:this.extension,getPos:()=>this.getPos(),updateAttributes:(r={})=>this.updateAttributes(r),deleteNode:()=>this.deleteNode()},n=this.onDragStart.bind(this);this.decorationClasses=Be(this.getDecorationClasses());const s=me({extends:{...this.component},props:Object.keys(t),template:this.component.template,setup:r=>{var i,o;return Tt("onDragStart",n),Tt("decorationClasses",this.decorationClasses),(o=(i=this.component).setup)===null||o===void 0?void 0:o.call(i,r,{expose:()=>{}})},__scopeId:this.component.__scopeId,__cssModules:this.component.__cssModules});this.renderer=new Bo(s,{editor:this.editor,props:t})}get dom(){if(!this.renderer.element.hasAttribute("data-node-view-wrapper"))throw Error("Please use the NodeViewWrapper component for your node view.");return this.renderer.element}get contentDOM(){return this.node.isLeaf?null:this.dom.querySelector("[data-node-view-content]")||this.dom}update(t,n){const s=r=>{this.decorationClasses.value=this.getDecorationClasses(),this.renderer.updateProps(r)};if(typeof this.options.update=="function"){const r=this.node,i=this.decorations;return this.node=t,this.decorations=n,this.options.update({oldNode:r,oldDecorations:i,newNode:t,newDecorations:n,updateProps:()=>s({node:t,decorations:n})})}return t.type!==this.node.type?!1:(t===this.node&&this.decorations===n||(this.node=t,this.decorations=n,s({node:t,decorations:n})),!0)}selectNode(){this.renderer.updateProps({selected:!0})}deselectNode(){this.renderer.updateProps({selected:!1})}getDecorationClasses(){return this.decorations.map(t=>t.type.attrs.class).flat().join(" ")}destroy(){this.renderer.destroy()}}function yl(e,t){return n=>n.editor.contentComponent?new $o(e,n,t):{}}const Do=/^```([a-z]+)?[\s\n]$/,jo=/^~~~([a-z]+)?[\s\n]$/,Mn=N.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:e=>{var t;const{languageClassPrefix:n}=this.options,i=[...((t=e.firstElementChild)===null||t===void 0?void 0:t.classList)||[]].filter(o=>o.startsWith(n)).map(o=>o.replace(n,""))[0];return i||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:e,HTMLAttributes:t}){return["pre",L(this.options.HTMLAttributes,t),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},addCommands(){return{setCodeBlock:e=>({commands:t})=>t.setNode(this.name,e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection,n=t.pos===1;return!e||t.parent.type.name!==this.name?!1:n||!t.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:t}=e,{selection:n}=t,{$from:s,empty:r}=n;if(!r||s.parent.type!==this.type)return!1;const i=s.parentOffset===s.parent.nodeSize-2,o=s.parent.textContent.endsWith(`

`);return!i||!o?!1:e.chain().command(({tr:a})=>(a.delete(s.pos-2,s.pos),!0)).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;const{state:t}=e,{selection:n,doc:s}=t,{$from:r,empty:i}=n;if(!i||r.parent.type!==this.type||!(r.parentOffset===r.parent.nodeSize-2))return!1;const a=r.after();return a===void 0||s.nodeAt(a)?!1:e.commands.exitCode()}}},addInputRules(){return[rt({find:Do,type:this.type,getAttributes:e=>({language:e[1]})}),rt({find:jo,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new z({key:new G("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;const n=t.clipboardData.getData("text/plain"),s=t.clipboardData.getData("vscode-editor-data"),r=s?JSON.parse(s):void 0,i=r==null?void 0:r.mode;if(!n||!i)return!1;const{tr:o}=e.state;return o.replaceSelectionWith(this.type.create({language:i})),o.setSelection(U.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.insertText(n.replace(/\r\n?/g,`
`)),o.setMeta("paste",!0),e.dispatch(o),!0}}})]}});var pt={exports:{}};function ft(e){return e instanceof Map?e.clear=e.delete=e.set=function(){throw new Error("map is read-only")}:e instanceof Set&&(e.add=e.clear=e.delete=function(){throw new Error("set is read-only")}),Object.freeze(e),Object.getOwnPropertyNames(e).forEach(function(t){var n=e[t];typeof n=="object"&&!Object.isFrozen(n)&&ft(n)}),e}pt.exports=ft;pt.exports.default=ft;class jt{constructor(t){t.data===void 0&&(t.data={}),this.data=t.data,this.isMatchIgnored=!1}ignoreMatch(){this.isMatchIgnored=!0}}function kn(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}function ne(e,...t){const n=Object.create(null);for(const s in e)n[s]=e[s];return t.forEach(function(s){for(const r in s)n[r]=s[r]}),n}const Fo="</span>",Ft=e=>!!e.scope||e.sublanguage&&e.language,Ko=(e,{prefix:t})=>{if(e.includes(".")){const n=e.split(".");return[`${t}${n.shift()}`,...n.map((s,r)=>`${s}${"_".repeat(r+1)}`)].join(" ")}return`${t}${e}`};class Wo{constructor(t,n){this.buffer="",this.classPrefix=n.classPrefix,t.walk(this)}addText(t){this.buffer+=kn(t)}openNode(t){if(!Ft(t))return;let n="";t.sublanguage?n=`language-${t.language}`:n=Ko(t.scope,{prefix:this.classPrefix}),this.span(n)}closeNode(t){Ft(t)&&(this.buffer+=Fo)}value(){return this.buffer}span(t){this.buffer+=`<span class="${t}">`}}const Kt=(e={})=>{const t={children:[]};return Object.assign(t,e),t};class ht{constructor(){this.rootNode=Kt(),this.stack=[this.rootNode]}get top(){return this.stack[this.stack.length-1]}get root(){return this.rootNode}add(t){this.top.children.push(t)}openNode(t){const n=Kt({scope:t});this.add(n),this.stack.push(n)}closeNode(){if(this.stack.length>1)return this.stack.pop()}closeAllNodes(){for(;this.closeNode(););}toJSON(){return JSON.stringify(this.rootNode,null,4)}walk(t){return this.constructor._walk(t,this.rootNode)}static _walk(t,n){return typeof n=="string"?t.addText(n):n.children&&(t.openNode(n),n.children.forEach(s=>this._walk(t,s)),t.closeNode(n)),t}static _collapse(t){typeof t!="string"&&t.children&&(t.children.every(n=>typeof n=="string")?t.children=[t.children.join("")]:t.children.forEach(n=>{ht._collapse(n)}))}}class zo extends ht{constructor(t){super(),this.options=t}addKeyword(t,n){t!==""&&(this.openNode(n),this.addText(t),this.closeNode())}addText(t){t!==""&&this.add(t)}addSublanguage(t,n){const s=t.root;s.sublanguage=!0,s.language=n,this.add(s)}toHTML(){return new Wo(this,this.options).value()}finalize(){return!0}}function ye(e){return e?typeof e=="string"?e:e.source:null}function vn(e){return ue("(?=",e,")")}function Vo(e){return ue("(?:",e,")*")}function Uo(e){return ue("(?:",e,")?")}function ue(...e){return e.map(n=>ye(n)).join("")}function qo(e){const t=e[e.length-1];return typeof t=="object"&&t.constructor===Object?(e.splice(e.length-1,1),t):{}}function mt(...e){return"("+(qo(e).capture?"":"?:")+e.map(s=>ye(s)).join("|")+")"}function wn(e){return new RegExp(e.toString()+"|").exec("").length-1}function Go(e,t){const n=e&&e.exec(t);return n&&n.index===0}const Jo=/\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9][0-9]*)|\\./;function gt(e,{joinWith:t}){let n=0;return e.map(s=>{n+=1;const r=n;let i=ye(s),o="";for(;i.length>0;){const a=Jo.exec(i);if(!a){o+=i;break}o+=i.substring(0,a.index),i=i.substring(a.index+a[0].length),a[0][0]==="\\"&&a[1]?o+="\\"+String(Number(a[1])+r):(o+=a[0],a[0]==="("&&n++)}return o}).map(s=>`(${s})`).join(t)}const Xo=/\b\B/,En="[a-zA-Z]\\w*",bt="[a-zA-Z_]\\w*",Tn="\\b\\d+(\\.\\d+)?",xn="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",Sn="\\b(0b[01]+)",Qo="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",Yo=(e={})=>{const t=/^#![ ]*\//;return e.binary&&(e.begin=ue(t,/.*\b/,e.binary,/\b.*/)),ne({scope:"meta",begin:t,end:/$/,relevance:0,"on:begin":(n,s)=>{n.index!==0&&s.ignoreMatch()}},e)},Me={begin:"\\\\[\\s\\S]",relevance:0},Zo={scope:"string",begin:"'",end:"'",illegal:"\\n",contains:[Me]},ei={scope:"string",begin:'"',end:'"',illegal:"\\n",contains:[Me]},ti={begin:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/},ze=function(e,t,n={}){const s=ne({scope:"comment",begin:e,end:t,contains:[]},n);s.contains.push({scope:"doctag",begin:"[ ]*(?=(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):)",end:/(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):/,excludeBegin:!0,relevance:0});const r=mt("I","a","is","so","us","to","at","if","in","it","on",/[A-Za-z]+['](d|ve|re|ll|t|s|n)/,/[A-Za-z]+[-][a-z]+/,/[A-Za-z][a-z]{2,}/);return s.contains.push({begin:ue(/[ ]+/,"(",r,/[.]?[:]?([.][ ]|[ ])/,"){3}")}),s},ni=ze("//","$"),si=ze("/\\*","\\*/"),ri=ze("#","$"),oi={scope:"number",begin:Tn,relevance:0},ii={scope:"number",begin:xn,relevance:0},ai={scope:"number",begin:Sn,relevance:0},li={begin:/(?=\/[^/\n]*\/)/,contains:[{scope:"regexp",begin:/\//,end:/\/[gimuy]*/,illegal:/\n/,contains:[Me,{begin:/\[/,end:/\]/,relevance:0,contains:[Me]}]}]},ci={scope:"title",begin:En,relevance:0},ui={scope:"title",begin:bt,relevance:0},di={begin:"\\.\\s*"+bt,relevance:0},pi=function(e){return Object.assign(e,{"on:begin":(t,n)=>{n.data._beginMatch=t[1]},"on:end":(t,n)=>{n.data._beginMatch!==t[1]&&n.ignoreMatch()}})};var Ae=Object.freeze({__proto__:null,MATCH_NOTHING_RE:Xo,IDENT_RE:En,UNDERSCORE_IDENT_RE:bt,NUMBER_RE:Tn,C_NUMBER_RE:xn,BINARY_NUMBER_RE:Sn,RE_STARTERS_RE:Qo,SHEBANG:Yo,BACKSLASH_ESCAPE:Me,APOS_STRING_MODE:Zo,QUOTE_STRING_MODE:ei,PHRASAL_WORDS_MODE:ti,COMMENT:ze,C_LINE_COMMENT_MODE:ni,C_BLOCK_COMMENT_MODE:si,HASH_COMMENT_MODE:ri,NUMBER_MODE:oi,C_NUMBER_MODE:ii,BINARY_NUMBER_MODE:ai,REGEXP_MODE:li,TITLE_MODE:ci,UNDERSCORE_TITLE_MODE:ui,METHOD_GUARD:di,END_SAME_AS_BEGIN:pi});function fi(e,t){e.input[e.index-1]==="."&&t.ignoreMatch()}function hi(e,t){e.className!==void 0&&(e.scope=e.className,delete e.className)}function mi(e,t){t&&e.beginKeywords&&(e.begin="\\b("+e.beginKeywords.split(" ").join("|")+")(?!\\.)(?=\\b|\\s)",e.__beforeBegin=fi,e.keywords=e.keywords||e.beginKeywords,delete e.beginKeywords,e.relevance===void 0&&(e.relevance=0))}function gi(e,t){Array.isArray(e.illegal)&&(e.illegal=mt(...e.illegal))}function bi(e,t){if(e.match){if(e.begin||e.end)throw new Error("begin & end are not supported with match");e.begin=e.match,delete e.match}}function yi(e,t){e.relevance===void 0&&(e.relevance=1)}const Mi=(e,t)=>{if(!e.beforeMatch)return;if(e.starts)throw new Error("beforeMatch cannot be used with starts");const n=Object.assign({},e);Object.keys(e).forEach(s=>{delete e[s]}),e.keywords=n.keywords,e.begin=ue(n.beforeMatch,vn(n.begin)),e.starts={relevance:0,contains:[Object.assign(n,{endsParent:!0})]},e.relevance=0,delete n.beforeMatch},ki=["of","and","for","in","not","or","if","then","parent","list","value"],vi="keyword";function An(e,t,n=vi){const s=Object.create(null);return typeof e=="string"?r(n,e.split(" ")):Array.isArray(e)?r(n,e):Object.keys(e).forEach(function(i){Object.assign(s,An(e[i],t,i))}),s;function r(i,o){t&&(o=o.map(a=>a.toLowerCase())),o.forEach(function(a){const l=a.split("|");s[l[0]]=[i,wi(l[0],l[1])]})}}function wi(e,t){return t?Number(t):Ei(e)?0:1}function Ei(e){return ki.includes(e.toLowerCase())}const Wt={},le=e=>{console.error(e)},zt=(e,...t)=>{console.log(`WARN: ${e}`,...t)},de=(e,t)=>{Wt[`${e}/${t}`]||(console.log(`Deprecated as of ${e}. ${t}`),Wt[`${e}/${t}`]=!0)},Pe=new Error;function Cn(e,t,{key:n}){let s=0;const r=e[n],i={},o={};for(let a=1;a<=t.length;a++)o[a+s]=r[a],i[a+s]=!0,s+=wn(t[a-1]);e[n]=o,e[n]._emit=i,e[n]._multi=!0}function Ti(e){if(Array.isArray(e.begin)){if(e.skip||e.excludeBegin||e.returnBegin)throw le("skip, excludeBegin, returnBegin not compatible with beginScope: {}"),Pe;if(typeof e.beginScope!="object"||e.beginScope===null)throw le("beginScope must be object"),Pe;Cn(e,e.begin,{key:"beginScope"}),e.begin=gt(e.begin,{joinWith:""})}}function xi(e){if(Array.isArray(e.end)){if(e.skip||e.excludeEnd||e.returnEnd)throw le("skip, excludeEnd, returnEnd not compatible with endScope: {}"),Pe;if(typeof e.endScope!="object"||e.endScope===null)throw le("endScope must be object"),Pe;Cn(e,e.end,{key:"endScope"}),e.end=gt(e.end,{joinWith:""})}}function Si(e){e.scope&&typeof e.scope=="object"&&e.scope!==null&&(e.beginScope=e.scope,delete e.scope)}function Ai(e){Si(e),typeof e.beginScope=="string"&&(e.beginScope={_wrap:e.beginScope}),typeof e.endScope=="string"&&(e.endScope={_wrap:e.endScope}),Ti(e),xi(e)}function Ci(e){function t(o,a){return new RegExp(ye(o),"m"+(e.case_insensitive?"i":"")+(e.unicodeRegex?"u":"")+(a?"g":""))}class n{constructor(){this.matchIndexes={},this.regexes=[],this.matchAt=1,this.position=0}addRule(a,l){l.position=this.position++,this.matchIndexes[this.matchAt]=l,this.regexes.push([l,a]),this.matchAt+=wn(a)+1}compile(){this.regexes.length===0&&(this.exec=()=>null);const a=this.regexes.map(l=>l[1]);this.matcherRe=t(gt(a,{joinWith:"|"}),!0),this.lastIndex=0}exec(a){this.matcherRe.lastIndex=this.lastIndex;const l=this.matcherRe.exec(a);if(!l)return null;const c=l.findIndex((d,p)=>p>0&&d!==void 0),u=this.matchIndexes[c];return l.splice(0,c),Object.assign(l,u)}}class s{constructor(){this.rules=[],this.multiRegexes=[],this.count=0,this.lastIndex=0,this.regexIndex=0}getMatcher(a){if(this.multiRegexes[a])return this.multiRegexes[a];const l=new n;return this.rules.slice(a).forEach(([c,u])=>l.addRule(c,u)),l.compile(),this.multiRegexes[a]=l,l}resumingScanAtSamePosition(){return this.regexIndex!==0}considerAll(){this.regexIndex=0}addRule(a,l){this.rules.push([a,l]),l.type==="begin"&&this.count++}exec(a){const l=this.getMatcher(this.regexIndex);l.lastIndex=this.lastIndex;let c=l.exec(a);if(this.resumingScanAtSamePosition()&&!(c&&c.index===this.lastIndex)){const u=this.getMatcher(0);u.lastIndex=this.lastIndex+1,c=u.exec(a)}return c&&(this.regexIndex+=c.position+1,this.regexIndex===this.count&&this.considerAll()),c}}function r(o){const a=new s;return o.contains.forEach(l=>a.addRule(l.begin,{rule:l,type:"begin"})),o.terminatorEnd&&a.addRule(o.terminatorEnd,{type:"end"}),o.illegal&&a.addRule(o.illegal,{type:"illegal"}),a}function i(o,a){const l=o;if(o.isCompiled)return l;[hi,bi,Ai,Mi].forEach(u=>u(o,a)),e.compilerExtensions.forEach(u=>u(o,a)),o.__beforeBegin=null,[mi,gi,yi].forEach(u=>u(o,a)),o.isCompiled=!0;let c=null;return typeof o.keywords=="object"&&o.keywords.$pattern&&(o.keywords=Object.assign({},o.keywords),c=o.keywords.$pattern,delete o.keywords.$pattern),c=c||/\w+/,o.keywords&&(o.keywords=An(o.keywords,e.case_insensitive)),l.keywordPatternRe=t(c,!0),a&&(o.begin||(o.begin=/\B|\b/),l.beginRe=t(l.begin),!o.end&&!o.endsWithParent&&(o.end=/\B|\b/),o.end&&(l.endRe=t(l.end)),l.terminatorEnd=ye(l.end)||"",o.endsWithParent&&a.terminatorEnd&&(l.terminatorEnd+=(o.end?"|":"")+a.terminatorEnd)),o.illegal&&(l.illegalRe=t(o.illegal)),o.contains||(o.contains=[]),o.contains=[].concat(...o.contains.map(function(u){return Oi(u==="self"?o:u)})),o.contains.forEach(function(u){i(u,l)}),o.starts&&i(o.starts,a),l.matcher=r(l),l}if(e.compilerExtensions||(e.compilerExtensions=[]),e.contains&&e.contains.includes("self"))throw new Error("ERR: contains `self` is not supported at the top-level of a language.  See documentation.");return e.classNameAliases=ne(e.classNameAliases||{}),i(e)}function On(e){return e?e.endsWithParent||On(e.starts):!1}function Oi(e){return e.variants&&!e.cachedVariants&&(e.cachedVariants=e.variants.map(function(t){return ne(e,{variants:null},t)})),e.cachedVariants?e.cachedVariants:On(e)?ne(e,{starts:e.starts?ne(e.starts):null}):Object.isFrozen(e)?ne(e):e}var Li="11.6.0";class Ri extends Error{constructor(t,n){super(t),this.name="HTMLInjectionError",this.html=n}}const Ze=kn,Vt=ne,Ut=Symbol("nomatch"),Hi=7,_i=function(e){const t=Object.create(null),n=Object.create(null),s=[];let r=!0;const i="Could not find the language '{}', did you forget to load/include a language module?",o={disableAutodetect:!0,name:"Plain text",contains:[]};let a={ignoreUnescapedHTML:!1,throwUnescapedHTML:!1,noHighlightRe:/^(no-?highlight)$/i,languageDetectRe:/\blang(?:uage)?-([\w-]+)\b/i,classPrefix:"hljs-",cssSelector:"pre code",languages:null,__emitter:zo};function l(g){return a.noHighlightRe.test(g)}function c(g){let E=g.className+" ";E+=g.parentNode?g.parentNode.className:"";const A=a.languageDetectRe.exec(E);if(A){const R=Y(A[1]);return R||(zt(i.replace("{}",A[1])),zt("Falling back to no-highlight mode for this block.",g)),R?A[1]:"no-highlight"}return E.split(/\s+/).find(R=>l(R)||Y(R))}function u(g,E,A){let R="",B="";typeof E=="object"?(R=g,A=E.ignoreIllegals,B=E.language):(de("10.7.0","highlight(lang, code, ...args) has been deprecated."),de("10.7.0",`Please use highlight(code, options) instead.
https://github.com/highlightjs/highlight.js/issues/2277`),B=g,R=E),A===void 0&&(A=!0);const J={code:R,language:B};Ee("before:highlight",J);const Z=J.result?J.result:d(J.language,J.code,A);return Z.code=J.code,Ee("after:highlight",Z),Z}function d(g,E,A,R){const B=Object.create(null);function J(y,w){return y.keywords[w]}function Z(){if(!T.keywords){j.addText(H);return}let y=0;T.keywordPatternRe.lastIndex=0;let w=T.keywordPatternRe.exec(H),S="";for(;w;){S+=H.substring(y,w.index);const O=te.case_insensitive?w[0].toLowerCase():w[0],K=J(T,O);if(K){const[X,Dn]=K;if(j.addText(S),S="",B[O]=(B[O]||0)+1,B[O]<=Hi&&(Se+=Dn),X.startsWith("_"))S+=w[0];else{const jn=te.classNameAliases[X]||X;j.addKeyword(w[0],jn)}}else S+=w[0];y=T.keywordPatternRe.lastIndex,w=T.keywordPatternRe.exec(H)}S+=H.substring(y),j.addText(S)}function Te(){if(H==="")return;let y=null;if(typeof T.subLanguage=="string"){if(!t[T.subLanguage]){j.addText(H);return}y=d(T.subLanguage,H,!0,Et[T.subLanguage]),Et[T.subLanguage]=y._top}else y=f(H,T.subLanguage.length?T.subLanguage:null);T.relevance>0&&(Se+=y.relevance),j.addSublanguage(y._emitter,y.language)}function V(){T.subLanguage!=null?Te():Z(),H=""}function ee(y,w){let S=1;const O=w.length-1;for(;S<=O;){if(!y._emit[S]){S++;continue}const K=te.classNameAliases[y[S]]||y[S],X=w[S];K?j.addKeyword(X,K):(H=X,Z(),H=""),S++}}function kt(y,w){return y.scope&&typeof y.scope=="string"&&j.openNode(te.classNameAliases[y.scope]||y.scope),y.beginScope&&(y.beginScope._wrap?(j.addKeyword(H,te.classNameAliases[y.beginScope._wrap]||y.beginScope._wrap),H=""):y.beginScope._multi&&(ee(y.beginScope,w),H="")),T=Object.create(y,{parent:{value:T}}),T}function vt(y,w,S){let O=Go(y.endRe,S);if(O){if(y["on:end"]){const K=new jt(y);y["on:end"](w,K),K.isMatchIgnored&&(O=!1)}if(O){for(;y.endsParent&&y.parent;)y=y.parent;return y}}if(y.endsWithParent)return vt(y.parent,w,S)}function Nn(y){return T.matcher.regexIndex===0?(H+=y[0],1):(qe=!0,0)}function Pn(y){const w=y[0],S=y.rule,O=new jt(S),K=[S.__beforeBegin,S["on:begin"]];for(const X of K)if(X&&(X(y,O),O.isMatchIgnored))return Nn(w);return S.skip?H+=w:(S.excludeBegin&&(H+=w),V(),!S.returnBegin&&!S.excludeBegin&&(H=w)),kt(S,y),S.returnBegin?0:w.length}function In(y){const w=y[0],S=E.substring(y.index),O=vt(T,y,S);if(!O)return Ut;const K=T;T.endScope&&T.endScope._wrap?(V(),j.addKeyword(w,T.endScope._wrap)):T.endScope&&T.endScope._multi?(V(),ee(T.endScope,y)):K.skip?H+=w:(K.returnEnd||K.excludeEnd||(H+=w),V(),K.excludeEnd&&(H=w));do T.scope&&j.closeNode(),!T.skip&&!T.subLanguage&&(Se+=T.relevance),T=T.parent;while(T!==O.parent);return O.starts&&kt(O.starts,y),K.returnEnd?0:w.length}function Bn(){const y=[];for(let w=T;w!==te;w=w.parent)w.scope&&y.unshift(w.scope);y.forEach(w=>j.openNode(w))}let xe={};function wt(y,w){const S=w&&w[0];if(H+=y,S==null)return V(),0;if(xe.type==="begin"&&w.type==="end"&&xe.index===w.index&&S===""){if(H+=E.slice(w.index,w.index+1),!r){const O=new Error(`0 width match regex (${g})`);throw O.languageName=g,O.badRule=xe.rule,O}return 1}if(xe=w,w.type==="begin")return Pn(w);if(w.type==="illegal"&&!A){const O=new Error('Illegal lexeme "'+S+'" for mode "'+(T.scope||"<unnamed>")+'"');throw O.mode=T,O}else if(w.type==="end"){const O=In(w);if(O!==Ut)return O}if(w.type==="illegal"&&S==="")return 1;if(Ue>1e5&&Ue>w.index*3)throw new Error("potential infinite loop, way more iterations than matches");return H+=S,S.length}const te=Y(g);if(!te)throw le(i.replace("{}",g)),new Error('Unknown language: "'+g+'"');const $n=Ci(te);let Ve="",T=R||$n;const Et={},j=new a.__emitter(a);Bn();let H="",Se=0,ie=0,Ue=0,qe=!1;try{for(T.matcher.considerAll();;){Ue++,qe?qe=!1:T.matcher.considerAll(),T.matcher.lastIndex=ie;const y=T.matcher.exec(E);if(!y)break;const w=E.substring(ie,y.index),S=wt(w,y);ie=y.index+S}return wt(E.substring(ie)),j.closeAllNodes(),j.finalize(),Ve=j.toHTML(),{language:g,value:Ve,relevance:Se,illegal:!1,_emitter:j,_top:T}}catch(y){if(y.message&&y.message.includes("Illegal"))return{language:g,value:Ze(E),illegal:!0,relevance:0,_illegalBy:{message:y.message,index:ie,context:E.slice(ie-100,ie+100),mode:y.mode,resultSoFar:Ve},_emitter:j};if(r)return{language:g,value:Ze(E),illegal:!1,relevance:0,errorRaised:y,_emitter:j,_top:T};throw y}}function p(g){const E={value:Ze(g),illegal:!1,relevance:0,_top:o,_emitter:new a.__emitter(a)};return E._emitter.addText(g),E}function f(g,E){E=E||a.languages||Object.keys(t);const A=p(g),R=E.filter(Y).filter(Mt).map(V=>d(V,g,!1));R.unshift(A);const B=R.sort((V,ee)=>{if(V.relevance!==ee.relevance)return ee.relevance-V.relevance;if(V.language&&ee.language){if(Y(V.language).supersetOf===ee.language)return 1;if(Y(ee.language).supersetOf===V.language)return-1}return 0}),[J,Z]=B,Te=J;return Te.secondBest=Z,Te}function m(g,E,A){const R=E&&n[E]||A;g.classList.add("hljs"),g.classList.add(`language-${R}`)}function h(g){let E=null;const A=c(g);if(l(A))return;if(Ee("before:highlightElement",{el:g,language:A}),g.children.length>0&&(a.ignoreUnescapedHTML||(console.warn("One of your code blocks includes unescaped HTML. This is a potentially serious security risk."),console.warn("https://github.com/highlightjs/highlight.js/wiki/security"),console.warn("The element with unescaped HTML:"),console.warn(g)),a.throwUnescapedHTML))throw new Ri("One of your code blocks includes unescaped HTML.",g.innerHTML);E=g;const R=E.textContent,B=A?u(R,{language:A,ignoreIllegals:!0}):f(R);g.innerHTML=B.value,m(g,A,B.language),g.result={language:B.language,re:B.relevance,relevance:B.relevance},B.secondBest&&(g.secondBest={language:B.secondBest.language,relevance:B.secondBest.relevance}),Ee("after:highlightElement",{el:g,result:B,text:R})}function b(g){a=Vt(a,g)}const M=()=>{I(),de("10.6.0","initHighlighting() deprecated.  Use highlightAll() now.")};function k(){I(),de("10.6.0","initHighlightingOnLoad() deprecated.  Use highlightAll() now.")}let C=!1;function I(){if(document.readyState==="loading"){C=!0;return}document.querySelectorAll(a.cssSelector).forEach(h)}function D(){C&&I()}typeof window<"u"&&window.addEventListener&&window.addEventListener("DOMContentLoaded",D,!1);function _(g,E){let A=null;try{A=E(e)}catch(R){if(le("Language definition for '{}' could not be registered.".replace("{}",g)),r)le(R);else throw R;A=o}A.name||(A.name=g),t[g]=A,A.rawDefinition=E.bind(null,e),A.aliases&&yt(A.aliases,{languageName:g})}function W(g){delete t[g];for(const E of Object.keys(n))n[E]===g&&delete n[E]}function oe(){return Object.keys(t)}function Y(g){return g=(g||"").toLowerCase(),t[g]||t[n[g]]}function yt(g,{languageName:E}){typeof g=="string"&&(g=[g]),g.forEach(A=>{n[A.toLowerCase()]=E})}function Mt(g){const E=Y(g);return E&&!E.disableAutodetect}function Rn(g){g["before:highlightBlock"]&&!g["before:highlightElement"]&&(g["before:highlightElement"]=E=>{g["before:highlightBlock"](Object.assign({block:E.el},E))}),g["after:highlightBlock"]&&!g["after:highlightElement"]&&(g["after:highlightElement"]=E=>{g["after:highlightBlock"](Object.assign({block:E.el},E))})}function Hn(g){Rn(g),s.push(g)}function Ee(g,E){const A=g;s.forEach(function(R){R[A]&&R[A](E)})}function _n(g){return de("10.7.0","highlightBlock will be removed entirely in v12.0"),de("10.7.0","Please use highlightElement now."),h(g)}Object.assign(e,{highlight:u,highlightAuto:f,highlightAll:I,highlightElement:h,highlightBlock:_n,configure:b,initHighlighting:M,initHighlightingOnLoad:k,registerLanguage:_,unregisterLanguage:W,listLanguages:oe,getLanguage:Y,registerAliases:yt,autoDetection:Mt,inherit:Vt,addPlugin:Hn}),e.debugMode=function(){r=!1},e.safeMode=function(){r=!0},e.versionString=Li,e.regex={concat:ue,lookahead:vn,either:mt,optional:Uo,anyNumberOfTimes:Vo};for(const g in Ae)typeof Ae[g]=="object"&&pt.exports(Ae[g]);return Object.assign(e,Ae),e};var ke=_i({}),Ni=ke;ke.HighlightJS=ke;ke.default=ke;var Pi=Ni;function Ln(e,t=[]){return e.map(n=>{const s=[...t,...n.properties?n.properties.className:[]];return n.children?Ln(n.children,s):{text:n.value,classes:s}}).flat()}function qt(e){return e.value||e.children||[]}function Ii(e){return!!Pi.getLanguage(e)}function Gt({doc:e,name:t,lowlight:n,defaultLanguage:s}){const r=[];return nt(e,i=>i.type.name===t).forEach(i=>{let o=i.pos+1;const a=i.node.attrs.language||s,l=n.listLanguages(),c=a&&(l.includes(a)||Ii(a))?qt(n.highlight(a,i.node.textContent)):qt(n.highlightAuto(i.node.textContent));Ln(c).forEach(u=>{const d=o+u.text.length;if(u.classes.length){const p=Xn.inline(o,d,{class:u.classes.join(" ")});r.push(p)}o=d})}),Qn.create(e,r)}function Bi(e){return typeof e=="function"}function $i({name:e,lowlight:t,defaultLanguage:n}){if(!["highlight","highlightAuto","listLanguages"].every(r=>Bi(t[r])))throw Error("You should provide an instance of lowlight to use the code-block-lowlight extension");const s=new z({key:new G("lowlight"),state:{init:(r,{doc:i})=>Gt({doc:i,name:e,lowlight:t,defaultLanguage:n}),apply:(r,i,o,a)=>{const l=o.selection.$head.parent.type.name,c=a.selection.$head.parent.type.name,u=nt(o.doc,p=>p.type.name===e),d=nt(a.doc,p=>p.type.name===e);return r.docChanged&&([l,c].includes(e)||d.length!==u.length||r.steps.some(p=>p.from!==void 0&&p.to!==void 0&&u.some(f=>f.pos>=p.from&&f.pos+f.node.nodeSize<=p.to)))?Gt({doc:r.doc,name:e,lowlight:t,defaultLanguage:n}):i.map(r.mapping,r.doc)}},props:{decorations(r){return s.getState(r)}}});return s}const Ml=Mn.extend({addOptions(){var e;return{...(e=this.parent)===null||e===void 0?void 0:e.call(this),lowlight:{},defaultLanguage:null}},addProseMirrorPlugins(){var e;return[...((e=this.parent)===null||e===void 0?void 0:e.call(this))||[],$i({name:this.name,lowlight:this.options.lowlight,defaultLanguage:this.options.defaultLanguage})]}}),Di=/^\s*>\s$/,ji=N.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:e}){return["blockquote",L(this.options.HTMLAttributes,e),0]},addCommands(){return{setBlockquote:()=>({commands:e})=>e.wrapIn(this.name),toggleBlockquote:()=>({commands:e})=>e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[he({find:Di,type:this.type})]}}),Fi=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,Ki=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,Wi=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,zi=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g,Vi=q.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>e.style.fontWeight!=="normal"&&null},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML({HTMLAttributes:e}){return["strong",L(this.options.HTMLAttributes,e),0]},addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[ce({find:Fi,type:this.type}),ce({find:Wi,type:this.type})]},addPasteRules(){return[se({find:Ki,type:this.type}),se({find:zi,type:this.type})]}}),Ui=N.create({name:"listItem",addOptions(){return{HTMLAttributes:{}}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",L(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Jt=q.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:e=>e.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["span",L(this.options.HTMLAttributes,e),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:e,commands:t})=>{const n=we(e,this.type);return Object.entries(n).some(([,r])=>!!r)?!0:t.unsetMark(this.name)}}}}),Xt=/^\s*([-+*])\s$/,qi=N.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:e}){return["ul",L(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleBulletList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Ui.name,this.editor.getAttributes(Jt.name)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=he({find:Xt,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=he({find:Xt,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Jt.name),editor:this.editor})),[e]}}),Gi=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/,Ji=/(?:^|\s)((?:`)((?:[^`]+))(?:`))/g,Xi=q.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:e}){return["code",L(this.options.HTMLAttributes,e),0]},addCommands(){return{setCode:()=>({commands:e})=>e.setMark(this.name),toggleCode:()=>({commands:e})=>e.toggleMark(this.name),unsetCode:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[ce({find:Gi,type:this.type})]},addPasteRules(){return[se({find:Ji,type:this.type})]}}),Qi=N.create({name:"doc",topNode:!0,content:"block+"}),Yi=$.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[Yn(this.options)]}}),Zi=$.create({name:"gapCursor",addProseMirrorPlugins(){return[Zn()]},extendNodeSchema(e){var t;const n={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:(t=x(v(e,"allowGapCursor",n)))!==null&&t!==void 0?t:null}}}),ea=N.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:e}){return["br",L(this.options.HTMLAttributes,e)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:e,chain:t,state:n,editor:s})=>e.first([()=>e.exitCode(),()=>e.command(()=>{const{selection:r,storedMarks:i}=n;if(r.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:a}=s.extensionManager,l=i||r.$to.parentOffset&&r.$from.marks();return t().insertContent({type:this.name}).command(({tr:c,dispatch:u})=>{if(u&&l&&o){const d=l.filter(p=>a.includes(p.type.name));c.ensureMarks(d)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),ta=N.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(e=>({tag:`h${e}`,attrs:{level:e}}))},renderHTML({node:e,HTMLAttributes:t}){return[`h${this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]}`,L(this.options.HTMLAttributes,t),0]},addCommands(){return{setHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.setNode(this.name,e):!1,toggleHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.toggleNode(this.name,"paragraph",e):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>({...e,[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(e=>rt({find:new RegExp(`^(#{1,${e}})\\s$`),type:this.type,getAttributes:{level:e}}))}}),na=$.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:e,dispatch:t})=>es(e,t),redo:()=>({state:e,dispatch:t})=>ts(e,t)}},addProseMirrorPlugins(){return[ns(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-я":()=>this.editor.commands.undo(),"Shift-Mod-я":()=>this.editor.commands.redo()}}}),sa=N.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:e}){return["hr",L(this.options.HTMLAttributes,e)]},addCommands(){return{setHorizontalRule:()=>({chain:e})=>e().insertContent({type:this.name}).command(({tr:t,dispatch:n})=>{var s;if(n){const{$to:r}=t.selection,i=r.end();if(r.nodeAfter)t.setSelection(U.create(t.doc,r.pos));else{const o=(s=r.parent.type.contentMatch.defaultType)===null||s===void 0?void 0:s.create();o&&(t.insert(i,o),t.setSelection(U.create(t.doc,i)))}t.scrollIntoView()}return!0}).run()}},addInputRules(){return[gn({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),ra=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,oa=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,ia=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,aa=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g,la=q.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>e.style.fontStyle!=="normal"&&null},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:e}){return["em",L(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[ce({find:ra,type:this.type}),ce({find:ia,type:this.type})]},addPasteRules(){return[se({find:oa,type:this.type}),se({find:aa,type:this.type})]}}),ca=N.create({name:"listItem",addOptions(){return{HTMLAttributes:{}}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",L(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),ua=N.create({name:"listItem",addOptions(){return{HTMLAttributes:{}}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",L(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Qt=q.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:e=>e.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["span",L(this.options.HTMLAttributes,e),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:e,commands:t})=>{const n=we(e,this.type);return Object.entries(n).some(([,r])=>!!r)?!0:t.unsetMark(this.name)}}}}),Yt=/^(\d+)\.\s$/,da=N.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:e}){const{start:t,...n}=e;return t===1?["ol",L(this.options.HTMLAttributes,n),0]:["ol",L(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleOrderedList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(ua.name,this.editor.getAttributes(Qt.name)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=he({find:Yt,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,n)=>n.childCount+n.attrs.start===+t[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=he({find:Yt,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:t=>({start:+t[1],...this.editor.getAttributes(Qt.name)}),joinPredicate:(t,n)=>n.childCount+n.attrs.start===+t[1],editor:this.editor})),[e]}}),pa=N.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:e}){return["p",L(this.options.HTMLAttributes,e),0]},addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),fa=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/,ha=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/g,ma=q.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["s",L(this.options.HTMLAttributes,e),0]},addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-x":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[ce({find:fa,type:this.type})]},addPasteRules(){return[se({find:ha,type:this.type})]}}),ga=N.create({name:"text",group:"inline"}),kl=$.create({name:"starterKit",addExtensions(){var e,t,n,s,r,i,o,a,l,c,u,d,p,f,m,h,b,M;const k=[];return this.options.blockquote!==!1&&k.push(ji.configure((e=this.options)===null||e===void 0?void 0:e.blockquote)),this.options.bold!==!1&&k.push(Vi.configure((t=this.options)===null||t===void 0?void 0:t.bold)),this.options.bulletList!==!1&&k.push(qi.configure((n=this.options)===null||n===void 0?void 0:n.bulletList)),this.options.code!==!1&&k.push(Xi.configure((s=this.options)===null||s===void 0?void 0:s.code)),this.options.codeBlock!==!1&&k.push(Mn.configure((r=this.options)===null||r===void 0?void 0:r.codeBlock)),this.options.document!==!1&&k.push(Qi.configure((i=this.options)===null||i===void 0?void 0:i.document)),this.options.dropcursor!==!1&&k.push(Yi.configure((o=this.options)===null||o===void 0?void 0:o.dropcursor)),this.options.gapcursor!==!1&&k.push(Zi.configure((a=this.options)===null||a===void 0?void 0:a.gapcursor)),this.options.hardBreak!==!1&&k.push(ea.configure((l=this.options)===null||l===void 0?void 0:l.hardBreak)),this.options.heading!==!1&&k.push(ta.configure((c=this.options)===null||c===void 0?void 0:c.heading)),this.options.history!==!1&&k.push(na.configure((u=this.options)===null||u===void 0?void 0:u.history)),this.options.horizontalRule!==!1&&k.push(sa.configure((d=this.options)===null||d===void 0?void 0:d.horizontalRule)),this.options.italic!==!1&&k.push(la.configure((p=this.options)===null||p===void 0?void 0:p.italic)),this.options.listItem!==!1&&k.push(ca.configure((f=this.options)===null||f===void 0?void 0:f.listItem)),this.options.orderedList!==!1&&k.push(da.configure((m=this.options)===null||m===void 0?void 0:m.orderedList)),this.options.paragraph!==!1&&k.push(pa.configure((h=this.options)===null||h===void 0?void 0:h.paragraph)),this.options.strike!==!1&&k.push(ma.configure((b=this.options)===null||b===void 0?void 0:b.strike)),this.options.text!==!1&&k.push(ga.configure((M=this.options)===null||M===void 0?void 0:M.text)),k}}),ba=/(?:^|\s)((?:==)((?:[^~=]+))(?:==))$/,ya=/(?:^|\s)((?:==)((?:[^~=]+))(?:==))/g,vl=q.create({name:"highlight",addOptions(){return{multicolor:!1,HTMLAttributes:{}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:e=>e.getAttribute("data-color")||e.style.backgroundColor,renderHTML:e=>e.color?{"data-color":e.color,style:`background-color: ${e.color}; color: inherit`}:{}}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:e}){return["mark",L(this.options.HTMLAttributes,e),0]},addCommands(){return{setHighlight:e=>({commands:t})=>t.setMark(this.name,e),toggleHighlight:e=>({commands:t})=>t.toggleMark(this.name,e),unsetHighlight:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[ce({find:ba,type:this.type})]},addPasteRules(){return[se({find:ya,type:this.type})]}}),Ma=/^\s*(\[([( |x])?\])\s$/,wl=N.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{}}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:e=>e.getAttribute("data-checked")==="true",renderHTML:e=>({"data-checked":e.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:e,HTMLAttributes:t}){return["li",L(this.options.HTMLAttributes,t,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:e.attrs.checked?"checked":null}],["span"]],["div",0]]},addKeyboardShortcuts(){const e={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...e,Tab:()=>this.editor.commands.sinkListItem(this.name)}:e},addNodeView(){return({node:e,HTMLAttributes:t,getPos:n,editor:s})=>{const r=document.createElement("li"),i=document.createElement("label"),o=document.createElement("span"),a=document.createElement("input"),l=document.createElement("div");return i.contentEditable="false",a.type="checkbox",a.addEventListener("change",c=>{if(!s.isEditable&&!this.options.onReadOnlyChecked){a.checked=!a.checked;return}const{checked:u}=c.target;s.isEditable&&typeof n=="function"&&s.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:d})=>{const p=n(),f=d.doc.nodeAt(p);return d.setNodeMarkup(p,void 0,{...f==null?void 0:f.attrs,checked:u}),!0}).run(),!s.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(e,u)||(a.checked=!a.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([c,u])=>{r.setAttribute(c,u)}),r.dataset.checked=e.attrs.checked,e.attrs.checked&&a.setAttribute("checked","checked"),i.append(a,o),r.append(i,l),Object.entries(t).forEach(([c,u])=>{r.setAttribute(c,u)}),{dom:r,contentDOM:l,update:c=>c.type!==this.type?!1:(r.dataset.checked=c.attrs.checked,c.attrs.checked?a.setAttribute("checked","checked"):a.removeAttribute("checked"),!0)}}},addInputRules(){return[he({find:Ma,type:this.type,getAttributes:e=>({checked:e[e.length-1]==="x"})})]}}),El=N.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:e}){return["ul",L(this.options.HTMLAttributes,e,{"data-type":this.name}),0]},addCommands(){return{toggleTaskList:()=>({commands:e})=>e.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}}),ka=P({find:/--$/,replace:"—"}),va=P({find:/\.\.\.$/,replace:"…"}),wa=P({find:/(?:^|[\s{[(<'"\u2018\u201C])(")$/,replace:"“"}),Ea=P({find:/"$/,replace:"”"}),Ta=P({find:/(?:^|[\s{[(<'"\u2018\u201C])(')$/,replace:"‘"}),xa=P({find:/'$/,replace:"’"}),Sa=P({find:/<-$/,replace:"←"}),Aa=P({find:/->$/,replace:"→"}),Ca=P({find:/\(c\)$/,replace:"©"}),Oa=P({find:/\(tm\)$/,replace:"™"}),La=P({find:/\(sm\)$/,replace:"℠"}),Ra=P({find:/\(r\)$/,replace:"®"}),Ha=P({find:/(?:^|\s)(1\/2)$/,replace:"½"}),_a=P({find:/\+\/-$/,replace:"±"}),Na=P({find:/!=$/,replace:"≠"}),Pa=P({find:/<<$/,replace:"«"}),Ia=P({find:/>>$/,replace:"»"}),Ba=P({find:/\d+\s?([*x])\s?\d+$/,replace:"×"}),$a=P({find:/\^2$/,replace:"²"}),Da=P({find:/\^3$/,replace:"³"}),ja=P({find:/(?:^|\s)(1\/4)$/,replace:"¼"}),Fa=P({find:/(?:^|\s)(3\/4)$/,replace:"¾"}),Tl=$.create({name:"typography",addInputRules(){const e=[];return this.options.emDash!==!1&&e.push(ka),this.options.ellipsis!==!1&&e.push(va),this.options.openDoubleQuote!==!1&&e.push(wa),this.options.closeDoubleQuote!==!1&&e.push(Ea),this.options.openSingleQuote!==!1&&e.push(Ta),this.options.closeSingleQuote!==!1&&e.push(xa),this.options.leftArrow!==!1&&e.push(Sa),this.options.rightArrow!==!1&&e.push(Aa),this.options.copyright!==!1&&e.push(Ca),this.options.trademark!==!1&&e.push(Oa),this.options.servicemark!==!1&&e.push(La),this.options.registeredTrademark!==!1&&e.push(Ra),this.options.oneHalf!==!1&&e.push(Ha),this.options.plusMinus!==!1&&e.push(_a),this.options.notEqual!==!1&&e.push(Na),this.options.laquo!==!1&&e.push(Pa),this.options.raquo!==!1&&e.push(Ia),this.options.multiplication!==!1&&e.push(Ba),this.options.superscriptTwo!==!1&&e.push($a),this.options.superscriptThree!==!1&&e.push(Da),this.options.oneQuarter!==!1&&e.push(ja),this.options.threeQuarters!==!1&&e.push(Fa),e}}),xl=q.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:e=>e.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["span",L(this.options.HTMLAttributes,e),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:e,commands:t})=>{const n=we(e,this.type);return Object.entries(n).some(([,r])=>!!r)?!0:t.unsetMark(this.name)}}}}),Sl=$.create({name:"fontFamily",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontFamily:{default:null,parseHTML:e=>{var t;return(t=e.style.fontFamily)===null||t===void 0?void 0:t.replace(/['"]+/g,"")},renderHTML:e=>e.fontFamily?{style:`font-family: ${e.fontFamily}`}:{}}}}]},addCommands(){return{setFontFamily:e=>({chain:t})=>t().setMark("textStyle",{fontFamily:e}).run(),unsetFontFamily:()=>({chain:e})=>e().setMark("textStyle",{fontFamily:null}).removeEmptyTextStyle().run()}}}),Ka=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,Al=N.create({name:"image",addOptions(){return{inline:!1,allowBase64:!1,HTMLAttributes:{}}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null}}},parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:e}){return["img",L(this.options.HTMLAttributes,e)]},addCommands(){return{setImage:e=>({commands:t})=>t.insertContent({type:this.name,attrs:e})}},addInputRules(){return[gn({find:Ka,type:this.type,getAttributes:e=>{const[,,t,n,s]=e;return{src:n,alt:t,title:s}}})]}});function Zt(e,t,n,s,r,i){let o=0,a=!0,l=t.firstChild;const c=e.firstChild;for(let u=0,d=0;u<c.childCount;u+=1){const{colspan:p,colwidth:f}=c.child(u).attrs;for(let m=0;m<p;m+=1,d+=1){const h=r===d?i:f&&f[m],b=h?`${h}px`:"";o+=h||s,h||(a=!1),l?(l.style.width!==b&&(l.style.width=b),l=l.nextSibling):t.appendChild(document.createElement("col")).style.width=b}}for(;l;){const u=l.nextSibling;l.parentNode.removeChild(l),l=u}a?(n.style.width=`${o}px`,n.style.minWidth=""):(n.style.width="",n.style.minWidth=`${o}px`)}class Wa{constructor(t,n){this.node=t,this.cellMinWidth=n,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),Zt(t,this.colgroup,this.table,n),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(t){return t.type!==this.node.type?!1:(this.node=t,Zt(t,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(t){return t.type==="attributes"&&(t.target===this.table||this.colgroup.contains(t.target))}}function en(e,t){return t?e.createChecked(null,t):e.createAndFill()}function za(e){if(e.cached.tableNodeTypes)return e.cached.tableNodeTypes;const t={};return Object.keys(e.nodes).forEach(n=>{const s=e.nodes[n];s.spec.tableRole&&(t[s.spec.tableRole]=s)}),e.cached.tableNodeTypes=t,t}function Va(e,t,n,s,r){const i=za(e),o=[],a=[];for(let c=0;c<n;c+=1){const u=en(i.cell,r);if(u&&a.push(u),s){const d=en(i.header_cell,r);d&&o.push(d)}}const l=[];for(let c=0;c<t;c+=1)l.push(i.row.createChecked(null,s&&c===0?o:a));return i.table.createChecked(null,l)}function Ua(e){return e instanceof rn}const Ce=({editor:e})=>{const{selection:t}=e.state;if(!Ua(t))return!1;let n=0;const s=fn(t.ranges[0].$from,i=>i.type.name==="table");return s==null||s.node.descendants(i=>{if(i.type.name==="table")return!1;["tableCell","tableHeader"].includes(i.type.name)&&(n+=1)}),n===t.ranges.length?(e.commands.deleteTable(),!0):!1},Cl=N.create({name:"table",addOptions(){return{HTMLAttributes:{},resizable:!1,handleWidth:5,cellMinWidth:25,View:Wa,lastColumnResizable:!0,allowTableNodeSelection:!1}},content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML(){return[{tag:"table"}]},renderHTML({HTMLAttributes:e}){return["table",L(this.options.HTMLAttributes,e),["tbody",0]]},addCommands(){return{insertTable:({rows:e=3,cols:t=3,withHeaderRow:n=!0}={})=>({tr:s,dispatch:r,editor:i})=>{const o=Va(i.schema,e,t,n);if(r){const a=s.selection.anchor+1;s.replaceSelectionWith(o).scrollIntoView().setSelection(U.near(s.doc.resolve(a)))}return!0},addColumnBefore:()=>({state:e,dispatch:t})=>ss(e,t),addColumnAfter:()=>({state:e,dispatch:t})=>rs(e,t),deleteColumn:()=>({state:e,dispatch:t})=>os(e,t),addRowBefore:()=>({state:e,dispatch:t})=>is(e,t),addRowAfter:()=>({state:e,dispatch:t})=>as(e,t),deleteRow:()=>({state:e,dispatch:t})=>ls(e,t),deleteTable:()=>({state:e,dispatch:t})=>cs(e,t),mergeCells:()=>({state:e,dispatch:t})=>xt(e,t),splitCell:()=>({state:e,dispatch:t})=>St(e,t),toggleHeaderColumn:()=>({state:e,dispatch:t})=>At("column")(e,t),toggleHeaderRow:()=>({state:e,dispatch:t})=>At("row")(e,t),toggleHeaderCell:()=>({state:e,dispatch:t})=>us(e,t),mergeOrSplit:()=>({state:e,dispatch:t})=>xt(e,t)?!0:St(e,t),setCellAttribute:(e,t)=>({state:n,dispatch:s})=>ds(e,t)(n,s),goToNextCell:()=>({state:e,dispatch:t})=>Ct(1)(e,t),goToPreviousCell:()=>({state:e,dispatch:t})=>Ct(-1)(e,t),fixTables:()=>({state:e,dispatch:t})=>(t&&ps(e),!0),setCellSelection:e=>({tr:t,dispatch:n})=>{if(n){const s=rn.create(t.doc,e.anchorCell,e.headCell);t.setSelection(s)}return!0}}},addKeyboardShortcuts(){return{Tab:()=>this.editor.commands.goToNextCell()?!0:this.editor.can().addRowAfter()?this.editor.chain().addRowAfter().goToNextCell().run():!1,"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:Ce,"Mod-Backspace":Ce,Delete:Ce,"Mod-Delete":Ce}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[fs({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],hs({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema(e){const t={name:e.name,options:e.options,storage:e.storage};return{tableRole:x(v(e,"tableRole",t))}}}),Ol=N.create({name:"tableCell",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:e=>{const t=e.getAttribute("colwidth");return t?[parseInt(t,10)]:null}}}},tableRole:"cell",isolating:!0,parseHTML(){return[{tag:"td"}]},renderHTML({HTMLAttributes:e}){return["td",L(this.options.HTMLAttributes,e),0]}}),Ll=N.create({name:"tableHeader",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:e=>{const t=e.getAttribute("colwidth");return t?[parseInt(t,10)]:null}}}},tableRole:"header_cell",isolating:!0,parseHTML(){return[{tag:"th"}]},renderHTML({HTMLAttributes:e}){return["th",L(this.options.HTMLAttributes,e),0]}}),Rl=N.create({name:"tableRow",addOptions(){return{HTMLAttributes:{}}},content:"(tableCell | tableHeader)*",tableRole:"row",parseHTML(){return[{tag:"tr"}]},renderHTML({HTMLAttributes:e}){return["tr",L(this.options.HTMLAttributes,e),0]}}),Hl=$.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:e=>{var t;return(t=e.style.color)===null||t===void 0?void 0:t.replace(/['"]+/g,"")},renderHTML:e=>e.color?{style:`color: ${e.color}`}:{}}}}]},addCommands(){return{setColor:e=>({chain:t})=>t().setMark("textStyle",{color:e}).run(),unsetColor:()=>({chain:e})=>e().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}}),_l=$.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:"left"}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:e=>e.style.textAlign||this.options.defaultAlignment,renderHTML:e=>e.textAlign===this.options.defaultAlignment?{}:{style:`text-align: ${e.textAlign}`}}}}]},addCommands(){return{setTextAlign:e=>({commands:t})=>this.options.alignments.includes(e)?this.options.types.every(n=>t.updateAttributes(n,{textAlign:e})):!1,unsetTextAlign:()=>({commands:e})=>this.options.types.every(t=>e.resetAttributes(t,"textAlign"))}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}});function qa(e){return new z({key:new G("autolink"),appendTransaction:(t,n,s)=>{const r=t.some(u=>u.docChanged)&&!n.doc.eq(s.doc),i=t.some(u=>u.getMeta("preventAutolink"));if(!r||i)return;const{tr:o}=s,a=Vr(n.doc,[...t]),{mapping:l}=a;if(Zr(a).forEach(({oldRange:u,newRange:d})=>{Ne(u.from,u.to,n.doc).filter(h=>h.mark.type===e.type).forEach(h=>{const b=l.map(h.from),M=l.map(h.to),k=Ne(b,M,s.doc).filter(oe=>oe.mark.type===e.type);if(!k.length)return;const C=k[0],I=n.doc.textBetween(h.from,h.to,void 0," "),D=s.doc.textBetween(C.from,C.to,void 0," "),_=Rt(I),W=Rt(D);_&&!W&&o.removeMark(C.from,C.to,e.type)});const p=qr(s.doc,d,h=>h.isTextblock);let f,m;if(p.length>1?(f=p[0],m=s.doc.textBetween(f.pos,f.pos+f.node.nodeSize,void 0," ")):p.length&&s.doc.textBetween(d.from,d.to," "," ").endsWith(" ")&&(f=p[0],m=s.doc.textBetween(f.pos,d.to,void 0," ")),f&&m){const h=m.split(" ").filter(k=>k!=="");if(h.length<=0)return!1;const b=h[h.length-1],M=f.pos+m.lastIndexOf(b);if(!b)return!1;at(b).filter(k=>k.isLink).filter(k=>e.validate?e.validate(k.value):!0).map(k=>({...k,from:M+k.start+1,to:M+k.end+1})).forEach(k=>{o.addMark(k.from,k.to,e.type.create({href:k.href}))})}}),!!o.steps.length)return o}})}function Ga(e){return new z({key:new G("handleClickLink"),props:{handleClick:(t,n,s)=>{var r,i,o;if(s.button!==0)return!1;const a=hn(t.state,e.type.name),l=(r=s.target)===null||r===void 0?void 0:r.closest("a"),c=(i=l==null?void 0:l.href)!==null&&i!==void 0?i:a.href,u=(o=l==null?void 0:l.target)!==null&&o!==void 0?o:a.target;return l&&c?(window.open(c,u),!0):!1}}})}function Ja(e){return new z({key:new G("handlePasteLink"),props:{handlePaste:(t,n,s)=>{const{state:r}=t,{selection:i}=r,{empty:o}=i;if(o)return!1;let a="";s.content.forEach(c=>{a+=c.textContent});const l=at(a).find(c=>c.isLink&&c.value===a);return!a||!l?!1:(e.editor.commands.setMark(e.type,{href:l.href}),!0)}}})}const Nl=q.create({name:"link",priority:1e3,keepOnSplit:!1,onCreate(){this.options.protocols.forEach(e=>{if(typeof e=="string"){Lt(e);return}Lt(e.scheme,e.optionalSlashes)})},onDestroy(){zs()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,linkOnPaste:!0,autolink:!0,protocols:[],HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},validate:void 0}},addAttributes(){return{href:{default:null},target:{default:this.options.HTMLAttributes.target},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:'a[href]:not([href *= "javascript:" i])'}]},renderHTML({HTMLAttributes:e}){return["a",L(this.options.HTMLAttributes,e),0]},addCommands(){return{setLink:e=>({chain:t})=>t().setMark(this.name,e).setMeta("preventAutolink",!0).run(),toggleLink:e=>({chain:t})=>t().toggleMark(this.name,e,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run(),unsetLink:()=>({chain:e})=>e().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[se({find:e=>at(e).filter(t=>this.options.validate?this.options.validate(t.value):!0).filter(t=>t.isLink).map(t=>({text:t.value,index:t.start,data:t})),type:this.type,getAttributes:e=>{var t;return{href:(t=e.data)===null||t===void 0?void 0:t.href}}})]},addProseMirrorPlugins(){const e=[];return this.options.autolink&&e.push(qa({type:this.type,validate:this.options.validate})),this.options.openOnClick&&e.push(Ga({type:this.type})),this.options.linkOnPaste&&e.push(Ja({editor:this.editor,type:this.type})),e}});export{dl as B,Hl as C,$ as E,fl as F,Zi as G,vl as H,Al as I,Nl as L,ml as N,kl as S,Ol as T,yl as V,hl as a,N as b,Io as c,Tl as d,Sl as e,xl as f,El as g,wl as h,Bt as i,_l as j,Cl as k,Rl as l,L as m,bl as n,Ll as o,Ml as p,pl as q,P as t,gl as u};
